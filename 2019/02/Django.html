<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="python,web,django,">





  <link rel="alternate" href="/atom.xml" title="Kofe" type="application/atom+xml">






<meta name="description" content="Django æ˜¯åŸºäº MVC æ¨¡å¼ï¼Œç”± Python å†™æˆçš„å¼€æº Web åº”ç”¨æ¡†æ¶ã€‚åœ¨ Django ä¸­ï¼Œæ§åˆ¶å™¨æ¥å—ç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†ç”±æ¡†æ¶è‡ªè¡Œå¤„ç†ï¼Œè€Œ Django é‡Œæ›´å…³æ³¨çš„æ˜¯æ¨¡å‹ ( Model )ã€æ¨¡æ¿ ( Template ) å’Œè§†å›¾ ( Views )ï¼Œä¸ºæ­¤ä¹Ÿç§°å…¶ä¸º MTV æ¨¡å¼çš„ Web æ¡†æ¶ã€‚ äº‹å®ä¸Šï¼ŒåŸºäº Python çš„ Web æ¡†æ¶ä¸ä»…è¿™ä¸€å®¶ï¼Œå¦‚  flaskã€tornadoã€w">
<meta name="keywords" content="python,web,django">
<meta property="og:type" content="article">
<meta property="og:title" content="Djangoï¼šWeb æ¡†æ¶ä»å…¥é—¨åˆ°åº”ç”¨">
<meta property="og:url" content="http://www.kofes.cn/2019/02/Django.html">
<meta property="og:site_name" content="Kofe">
<meta property="og:description" content="Django æ˜¯åŸºäº MVC æ¨¡å¼ï¼Œç”± Python å†™æˆçš„å¼€æº Web åº”ç”¨æ¡†æ¶ã€‚åœ¨ Django ä¸­ï¼Œæ§åˆ¶å™¨æ¥å—ç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†ç”±æ¡†æ¶è‡ªè¡Œå¤„ç†ï¼Œè€Œ Django é‡Œæ›´å…³æ³¨çš„æ˜¯æ¨¡å‹ ( Model )ã€æ¨¡æ¿ ( Template ) å’Œè§†å›¾ ( Views )ï¼Œä¸ºæ­¤ä¹Ÿç§°å…¶ä¸º MTV æ¨¡å¼çš„ Web æ¡†æ¶ã€‚ äº‹å®ä¸Šï¼ŒåŸºäº Python çš„ Web æ¡†æ¶ä¸ä»…è¿™ä¸€å®¶ï¼Œå¦‚  flaskã€tornadoã€w">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://www.kofes.cn/images/illustration/Programme/2019/02/django_1-1.jpg">
<meta property="og:image" content="http://www.kofes.cn/images/illustration/Programme/2019/02/django_1-2.jpg">
<meta property="og:image" content="http://www.kofes.cn/images/illustration/Programme/2019/02/django_2-1.jpg">
<meta property="og:updated_time" content="2023-02-15T06:35:23.905Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Djangoï¼šWeb æ¡†æ¶ä»å…¥é—¨åˆ°åº”ç”¨">
<meta name="twitter:description" content="Django æ˜¯åŸºäº MVC æ¨¡å¼ï¼Œç”± Python å†™æˆçš„å¼€æº Web åº”ç”¨æ¡†æ¶ã€‚åœ¨ Django ä¸­ï¼Œæ§åˆ¶å™¨æ¥å—ç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†ç”±æ¡†æ¶è‡ªè¡Œå¤„ç†ï¼Œè€Œ Django é‡Œæ›´å…³æ³¨çš„æ˜¯æ¨¡å‹ ( Model )ã€æ¨¡æ¿ ( Template ) å’Œè§†å›¾ ( Views )ï¼Œä¸ºæ­¤ä¹Ÿç§°å…¶ä¸º MTV æ¨¡å¼çš„ Web æ¡†æ¶ã€‚ äº‹å®ä¸Šï¼ŒåŸºäº Python çš„ Web æ¡†æ¶ä¸ä»…è¿™ä¸€å®¶ï¼Œå¦‚  flaskã€tornadoã€w">
<meta name="twitter:image" content="http://www.kofes.cn/images/illustration/Programme/2019/02/django_1-1.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.kofes.cn/2019/02/Django.html">





  <title>Djangoï¼šWeb æ¡†æ¶ä»å…¥é—¨åˆ°åº”ç”¨ | Kofe</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?79b30ca99079b04e5fbf1ad6164bf0c1";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Kofe</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">å¾¡ç¬”è®°ä¹‹æœ¯é“¸é€ è¶…çº§ä¸ªä½“</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.kofes.cn/2019/02/Django.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Kofe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/profile/society_face_version_1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kofe">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Djangoï¼šWeb æ¡†æ¶ä»å…¥é—¨åˆ°åº”ç”¨</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-17T22:44:07+08:00">
                2019-02-17
              </time>
            

            

            
          </span>


	  
            <span class="post-updated">
              &nbsp; | &nbsp; æ›´æ–°äº
              <time itemprop="dateUpdated" datetime="2023-02-15T14:35:23+08:00" content="2023-02-15">
                2023-02-15
              </time>
            </span>
          


          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Project/" itemprop="url" rel="index">
                    <span itemprop="name">Project</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/02/Django.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/02/Django.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2019/02/Django.html" class="leancloud_visitors" data-flag-title="Djangoï¼šWeb æ¡†æ¶ä»å…¥é—¨åˆ°åº”ç”¨">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  8,603
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Django æ˜¯åŸºäº MVC æ¨¡å¼ï¼Œç”± Python å†™æˆçš„å¼€æº Web åº”ç”¨æ¡†æ¶ã€‚åœ¨ Django ä¸­ï¼Œæ§åˆ¶å™¨æ¥å—ç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†ç”±æ¡†æ¶è‡ªè¡Œå¤„ç†ï¼Œè€Œ Django é‡Œæ›´å…³æ³¨çš„æ˜¯æ¨¡å‹ ( Model )ã€æ¨¡æ¿ ( Template ) å’Œè§†å›¾ ( Views )ï¼Œä¸ºæ­¤ä¹Ÿç§°å…¶ä¸º MTV æ¨¡å¼çš„ Web æ¡†æ¶ã€‚</p>
<p>äº‹å®ä¸Šï¼ŒåŸºäº Python çš„ Web æ¡†æ¶ä¸ä»…è¿™ä¸€å®¶ï¼Œå¦‚  flaskã€tornadoã€web2py ç­‰ã€‚å¯¹äºä»»ä½•ä¸€æ¬¾æ¡†æ¶éƒ½æœ‰å®ƒè‡ªèº«çš„äº®ç‚¹å’Œç¼ºé™· $^{[2, 3]}$ï¼Œç»¼åˆéœ€æ±‚ã€æ€§èƒ½è¦æ±‚ç­‰è¯¸å¤šå› ç´ è€ƒé‡ï¼Œé€‰æ‹©åˆé€‚çš„æ¡†æ¶å³å¯ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬è¦å¼€å‘ä¸€æ¬¾æ•°æ®åº“é©±åŠ¨çš„å†…å®¹å‘å¸ƒä¸ç®¡ç†ç³»ç»Ÿï¼Œå€ŸåŠ© Django çš„ä¸­é—´ä»¶ <a href="https://baike.baidu.com/item/å¯¹è±¡å…³ç³»æ˜ å°„" target="_blank" rel="noopener">ORM</a> è®¾è®¡ä¼˜ç‚¹ï¼Œä½¿å¾—åœ¨æ“ä½œä¸šåŠ¡å¯¹è±¡æ—¶ï¼Œä¸éœ€è¦å’Œå¤æ‚çš„ SQL è¯­å¥æ‰“äº¤é“ï¼Œåªè¦åƒå¹³æ—¶ä¸€æ ·æ“ä½œå¯¹è±¡å³å¯ï¼Œä»¥é«˜æ•ˆç‡å®Œæˆè½»é‡çº§åç«¯ç³»ç»Ÿçš„å¼€å‘å·¥ä½œã€‚</p>
<a id="more"></a>
<h2 id="æ•™å­¦èµ„æº"><a href="#æ•™å­¦èµ„æº" class="headerlink" title="æ•™å­¦èµ„æº"></a>æ•™å­¦èµ„æº</h2><ul>
<li>ğŸ“º | è§†é¢‘ | <a href="https://www.bilibili.com/video/av22606568/?p=3" target="_blank" rel="noopener">è€ç”·å­©.Python å…¨æ ˆ: Django æ¡†æ¶å…¥é—¨åˆ°åº”ç”¨. 2018. bilibili.com</a></li>
<li>ğŸ“„ | æ–‡ç«  | <a href="https://docs.djangoproject.com/zh-hans/2.1/" target="_blank" rel="noopener">Django.Django å¿«é€Ÿå…¥é—¨&amp;ä¸­æ–‡ä½¿ç”¨æ–‡æ¡£. djangoproject.com</a></li>
</ul>
<h2 id="å¿«é€Ÿä¸Šæ‰‹"><a href="#å¿«é€Ÿä¸Šæ‰‹" class="headerlink" title="å¿«é€Ÿä¸Šæ‰‹"></a>å¿«é€Ÿä¸Šæ‰‹</h2><h3 id="å®‰è£…ä¸é…ç½®"><a href="#å®‰è£…ä¸é…ç½®" class="headerlink" title="å®‰è£…ä¸é…ç½®"></a>å®‰è£…ä¸é…ç½®</h3><ul>
<li><p>å®‰è£…ï¼šå‘½ä»¤è¡Œæ¨¡å¼å®‰è£… ( Mac / Linux ç”¨æˆ·æ³¨æ„ç®¡ç†å‘˜æƒé™ )</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install django</span><br><span class="line">pip install django == x.xx.xx</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>é…ç½®ï¼šé…ç½® Django é¡¹ç›®å¹¶åˆæ¬¡å¯åŠ¨å®ƒã€‚</p>
<ul>
<li><p>åˆ›å»ºé¡¹ç›®ï¼šå¯é€šè¿‡å‘½ä»¤æ¨¡å¼å¯åŠ¨é¡¹ç›® ( å¤šç”¨äºéƒ¨ç½²ç¯å¢ƒ )ï¼Œä¹Ÿå¯é€šè¿‡ PyCharm å¯åŠ¨ã€è¿è¡Œé¡¹ç›®ã€‚</p>
<ul>
<li>å‘½ä»¤æ¨¡å¼ï¼š<code>django-admin startproject mysite</code></li>
<li><p>PyCharmï¼šé€šè¿‡ PyCharm ä¸€æ­¥åˆ°ä½ï¼Œå³ <code>æ–°å»ºå·¥ç¨‹ &gt; Django &gt; ( å»ºç«‹å•ç‹¬çš„ Venv ) &gt; mysite</code>ã€‚</p>
<blockquote>
<p>Virtualenvï¼šä¸ºä¸€ä¸ªåº”ç”¨åˆ›å»ºä¸€å¥—â€œéš”ç¦»â€çš„ Python è¿è¡Œç¯å¢ƒï¼Œå…·ä½“é…ç½®æ–¹æ³•å¯å‚è€ƒ [1]ã€‚</p>
</blockquote>
</li>
</ul>
</li>
<li><p>é¡¹ç›®ç›®å½•ç»“æ„è¯´æ˜</p>
<ul>
<li><code>mysite</code>ï¼šåŒåç›®å½•ï¼Œå®ƒæ˜¯ä¸€ä¸ªçº¯ Python åŒ…ã€‚å®ƒçš„åå­—å°±æ˜¯å½“ä½ å¼•ç”¨å®ƒå†…éƒ¨ä»»ä½•ä¸œè¥¿æ—¶éœ€è¦ç”¨åˆ°çš„ Python åŒ…åï¼Œæ¯”å¦‚ mysite.urlsã€‚</li>
<li><code>__init__.py</code>ï¼šç©ºæ–‡ä»¶ï¼Œæ ‡è¯†è¿™ä¸ªç›®å½•åº”è¯†åˆ«ä¸º Python åŒ…ã€‚</li>
<li><code>settings.py</code>ï¼šDjango çš„é¡¹ç›®é…ç½®æ–‡ä»¶ã€‚</li>
<li><code>urls.py</code>ï¼šDjango é¡¹ç›®çš„ URL å£°æ˜ã€‚</li>
<li><code>wsgi.py</code>ï¼šWeb æœåŠ¡ç½‘å…³æ¥å£ ( Socket )ã€‚</li>
<li><p><code>manage.py</code>ï¼šå¯¹ç½‘ç»œæ‰€æœ‰ç®¡ç†æ˜¯é€šè¿‡å…¶æ¥å®ç°çš„ã€‚</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysite</span><br><span class="line">  â”œâ”€â”€â”€ mysite</span><br><span class="line">  â”‚ â”œâ”€â”€ init__.py</span><br><span class="line">  â”‚ â”œâ”€â”€ settings.py</span><br><span class="line">  â”‚ â”œâ”€â”€ urls.py</span><br><span class="line">  â”‚ â”œâ”€â”€ wsgi.gy</span><br><span class="line">  â””â”€â”€â”€ manage.py</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>ä½¿ç”¨ï¼šä»¥å‘½ä»¤æ¨¡å¼å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ä¸ºä¾‹ï¼Œå½“ç„¶å¯ä»¥ä½¿ç”¨ Pycharm ä¸€é”®è¿è¡Œã€‚</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver 127.0.0.1:8000</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="è¯·æ±‚ä¸å“åº”"><a href="#è¯·æ±‚ä¸å“åº”" class="headerlink" title="è¯·æ±‚ä¸å“åº”"></a>è¯·æ±‚ä¸å“åº”</h3><h4 id="è¿”å›å†…å®¹è‡³é¡µé¢"><a href="#è¿”å›å†…å®¹è‡³é¡µé¢" class="headerlink" title="è¿”å›å†…å®¹è‡³é¡µé¢"></a>è¿”å›å†…å®¹è‡³é¡µé¢</h4><p>è¿”å›å†…å®¹ ( Html å…ƒç´ æˆ–å¯¹è±¡ ) è‡³é¡µé¢ï¼Œä»£ç åº”åŒ…å«åœ¨ <code>urls.py</code> æ–‡ä»¶ä¸­ã€‚</p>
<ul>
<li><p>ä¸‹è¿°æ˜¯è¿”å›å­—ç¬¦ä¸²æˆ– Html å…ƒç´ çš„ç¤ºä¾‹ä»£ç ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> HttpResponse</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">arguments:</span></span><br><span class="line"><span class="string">	@param request æ”¾ç½®ç”¨æˆ·è¯·æ±‚ç›¸å…³çš„æ‰€æœ‰ä¿¡æ¯</span></span><br><span class="line"><span class="string">@return å“åº”ä¸è¿”å›å¤„ç†ç»“æœ</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">info</span><span class="params">(request)</span>:</span></span><br><span class="line">	<span class="comment"># 1. å¯è¿”å›å­—ç¬¦ä¸²</span></span><br><span class="line">	<span class="keyword">return</span> HttpResponse(<span class="string">"Hello World!"</span>)</span><br><span class="line">	<span class="comment"># 2. å¯è¿”å› Html å…ƒç´  (å¯¹è±¡)</span></span><br><span class="line">	<span class="comment"># return HttpResponse("&lt;input type='text' /&gt;")</span></span><br><span class="line">	</span><br><span class="line"><span class="comment"># è®¿é—® Site æ ¹ç›®å½•</span></span><br><span class="line">urlpatterns = [ url(<span class="string">''</span>, info), ]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="è¿”å›ç‹¬ç«‹-Html-é¡µé¢"><a href="#è¿”å›ç‹¬ç«‹-Html-é¡µé¢" class="headerlink" title="è¿”å›ç‹¬ç«‹ Html é¡µé¢"></a>è¿”å›ç‹¬ç«‹ Html é¡µé¢</h4><p>è¿”å›ç‹¬ç«‹ Html é¡µé¢ï¼Œä¸”å°è¯•æŠŠæ•°æ®è¿”å›åˆ°é¡µé¢ä¸­ã€‚</p>
<ul>
<li>Html é¡µé¢æ”¾ç½® <code>tempates</code> ç›®å½•ä¸‹ï¼›</li>
<li><p><code>settings.py</code> ä¸­é…ç½®æ¨¡æ¿çš„è·¯å¾„ ( å‘Šè¯‰ç¨‹åºç½‘é¡µæ¨¡æ¿åœ¨å“ªä¸ªç›®å½•ä¸‹ )ï¼›</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TEMPLATES = [</span><br><span class="line">	<span class="string">'DIRS'</span>: [os.path.join(BASE_DIR, <span class="string">'templates'</span>)]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p><code>urs.py</code> ä¸­åŠ å…¥è°ƒç”¨ä»£ç ï¼Œç»‘å®šè¯·æ±‚åœ°å€ä¸å¤„ç†å‡½æ•°ï¼›</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">info</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="comment"># render èƒ½æŠ“å–é¡µé¢å…¨éƒ¨ä¿¡æ¯ ( å®ƒä¹Ÿè°ƒç”¨äº† HttpResponse )</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">'info.html'</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>è‹¥è¦å¼•ç”¨èµ„æºç›®å½•ï¼Œå¦‚å­˜æ”¾ imagesã€css ç­‰ï¼Œåˆ™éœ€è¦åœ¨ <code>settings.py</code> ä¸­åŠ å…¥å£°æ˜è¯­å¥ã€‚</p>
<p>  å¼•ç”¨èµ„æºæ—¶ï¼Œéœ€è¦åŠ å…¥ <code>static</code>ã€‚ä¾‹å¦‚ <code>&lt;link rel=&quot;stylesheet&quot; href=&quot;static/style.css&quot;&gt;</code>ã€‚</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">STATIC_URL = <span class="string">'/static/'</span></span><br><span class="line">STATICFILES_DIRS = (</span><br><span class="line">    <span class="comment"># 'æ–‡ä»¶å' æ˜¯è‡ªç”±å‘½åçš„ï¼Œè¿™é‡Œå– 'static' æ˜¯ä¸ºäº†ç»Ÿä¸€å‘½å</span></span><br><span class="line">    os.path.join(BASE_DIR, <span class="string">'static'</span>), </span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="ç®€å•ç™»å½•åŠŸèƒ½"><a href="#ç®€å•ç™»å½•åŠŸèƒ½" class="headerlink" title="ç®€å•ç™»å½•åŠŸèƒ½"></a>ç®€å•ç™»å½•åŠŸèƒ½</h3><blockquote>
<p>æœ¬å®ä¾‹ä¸»è¦å±•ç¤ºçš„æ˜¯ï¼Œåœ¨ Django æ¡†æ¶ä¸‹ Web å‰åç«¯çš„äº¤äº’è¿‡ç¨‹ã€‚</p>
</blockquote>
<ul>
<li><p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ <code>urls.py</code> ä¸­é…ç½®è·¯ç”±å…³ç³»ï¼Œå¹¶ç»‘å®šè·¯ç”±è§¦å‘çš„å‡½æ•°ä»¥å®ç°åŠŸèƒ½ã€‚</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> HttpResponse, render, redirect</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¦–æ¬¡åŠ è½½é¡µé¢è°ƒç”¨çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(request)</span>:</span></span><br><span class="line">	<span class="comment"># GET å¯é€šè¿‡è¯·æ±‚çš„é“¾æ¥åœ°å€ä¼ å‚ï¼Œå¦‚ url?page=1</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="string">'GET'</span> == request.method):</span><br><span class="line">		<span class="comment">## render() æ˜¯æŠ“å–é¡µé¢å…¨éƒ¨ä¿¡æ¯ ( å®ƒä¹Ÿè°ƒç”¨äº† HttpResponse )</span></span><br><span class="line">		<span class="keyword">return</span> render(request, <span class="string">'login.html'</span>)</span><br><span class="line">				</span><br><span class="line"><span class="comment"># ç™»å½•æˆåŠŸåæŠŠæ•°æ®å›ä¼ åˆ°ç›®æ ‡é¡µé¢</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></span><br><span class="line">	user = request.POST</span><br><span class="line">	<span class="keyword">return</span> render(request, <span class="string">'index.html'</span>, &#123;</span><br><span class="line">		<span class="string">'username'</span>: str(user.get(<span class="string">'username'</span>)),</span><br><span class="line">		<span class="string">'password'</span>: &#123;</span><br><span class="line">			<span class="string">'origin'</span>: user.get(<span class="string">'password'</span>),</span><br><span class="line">			<span class="string">'encode'</span>: base64.b64encode( (user.get(<span class="string">'password'</span>) + user.get(<span class="string">'password'</span>)).encode(<span class="string">'utf-8'</span>) )</span><br><span class="line">		&#125;&#125;</span><br><span class="line">	)</span><br><span class="line">   </span><br><span class="line"><span class="comment"># path(ç›¸å¯¹åœ°å€, è°ƒç”¨å‡½æ•°)ï¼Œå¦‚è¯·æ±‚åœ°å€ä¸ºæ ¹ç›®å½•ï¼Œæ•…è¿™é‡Œå¡«å†™ '' </span></span><br><span class="line">urlpatterns = [ </span><br><span class="line">    path(<span class="string">''</span>, login), </span><br><span class="line">    path(<span class="string">'index'</span>, index), </span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>æœ€åé™„ä¸Šç›¸å…³è”çš„ <code>login.html</code> å’Œ <code>index.html</code>ã€‚</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- login.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>Information Page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"static/css/style.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>Welcome to use the exhibation page.<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">action</span>=<span class="string">"index"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">type</span>=<span class="string">"text"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">type</span>=<span class="string">"password"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">"login"</span> <span class="attr">type</span>=<span class="string">"submit"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>Home Index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"static/css/style.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>	</span><br><span class="line">	<span class="comment">&lt;!-- 1. æ¨¡æ¿ä¸­æ¥å—å‡½æ•°ä½“è¿”å›çš„å±æ€§ --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- &#123;&#123;&#125;&#125; ç‰¹æ®Šå ä½ç¬¦: Django render() ä¼šè‡ªåŠ¨è§£æå®ƒ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>username<span class="tag">&lt;/<span class="name">h2</span>&gt;</span> &#123;&#123; username &#125;&#125;</span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>password<span class="tag">&lt;/<span class="name">h2</span>&gt;</span> &#123;&#123; password.origin &#125;&#125; =&gt; &#123;&#123; password.encode &#125;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="comment">&lt;!-- æ¢è¡Œ --&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 2. æ¨¡æ¿ä¸­è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•å’Œå±æ€§ï¼Œä¾‹å¦‚å¾ªç¯ä½“ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">td</span>&gt;</span>Username<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; username &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">		&#123;% for key, value in password.items %&#125;</span><br><span class="line">		<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">td</span>&gt;</span>Password:&#123;&#123; key &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; value &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">		&#123;% endfor %&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="å¢åˆ æ”¹æŸ¥ç³»ç»Ÿ"><a href="#å¢åˆ æ”¹æŸ¥ç³»ç»Ÿ" class="headerlink" title="å¢åˆ æ”¹æŸ¥ç³»ç»Ÿ"></a>å¢åˆ æ”¹æŸ¥ç³»ç»Ÿ</h3><blockquote>
<p>æœ¬å®ä¾‹ä¸»è¦å±•ç¤ºçš„æ˜¯ Python ä¸æ•°æ®åº“çš„äº¤äº’è¿‡ç¨‹ã€‚</p>
</blockquote>
<h4 id="å»ºç«‹æ•°æ®è¡¨"><a href="#å»ºç«‹æ•°æ®è¡¨" class="headerlink" title="å»ºç«‹æ•°æ®è¡¨"></a>å»ºç«‹æ•°æ®è¡¨</h4><p>æ•°æ®å…³ç³»ï¼šè¿™é‡Œä»¥å­¦ç”Ÿ ( Student )ã€ä»»æ•™è€å¸ˆ ( Teacher ) å’Œè¯¾ç¨‹ ( Course ) ä¸‰ä¸ªå®ä½“ä¸ºä¾‹ï¼Œæ„å»ºæ•°æ®è¡¨ã€‚</p>
<ul>
<li>ER å›¾ï¼Œå¦‚å›¾ 4-1 æ‰€ç¤ºï¼š<ul>
<li>å­¦ç”Ÿå¯ä»¥é€‰ä¿®å¤šé—¨è¯¾ç¨‹ï¼Œä¸€é—¨è¯¾ç¨‹å¯ä»¥å¤šä¸ªå­¦ç”Ÿå‚ä¸ï¼Œå³å¤šå¯¹å¤šå…³ç³»ã€‚</li>
<li>è€å¸ˆåªèƒ½ä»»æ•™ä¸€é—¨è¯¾ç¨‹ï¼Œä½†æ˜¯ä¸€é—¨è¯¾ç¨‹æœ‰å¤šä¸ªè€å¸ˆå¼€è¯¾ï¼Œå³ä¸€å¯¹å¤šå…³ç³»ã€‚</li>
</ul>
</li>
</ul>
<p><img src="/images/illustration/Programme/2019/02/django_1-1.jpg" alt="django_1-1"></p>
<center>å›¾ 1-1 æ¼”ç¤ºæ•°æ®åº“çš„æ•°æ®å…³ç³»</center>

<ul>
<li>å…³ç³»æ¨¡å¼ï¼š<ul>
<li>å­¦ç”Ÿå®ä½“(å­¦ç”Ÿåºå·, å­¦ç”Ÿå§“å) == t<em>student(_sid</em>, name)</li>
<li>è¯¾ç¨‹å®ä½“(è¯¾ç¨‹åºå·, è¯¾å ‚åç§°) == t<em>course(_cid</em>, name)</li>
<li>è€å¸ˆå®ä½“(è€å¸ˆåºå·, è€å¸ˆå§“å) == t<em>teacher(_tid</em>, name, cid)</li>
<li>é€‰è¯¾å…³ç³»(å­¦ç”Ÿåºå·, è¯¾ç¨‹åºå·, æˆç»©) == Student2Course(<em>sid</em>, <em>cid</em>, score)</li>
</ul>
</li>
</ul>
<h4 id="å‰-åç«¯äº¤äº’åŸç†"><a href="#å‰-åç«¯äº¤äº’åŸç†" class="headerlink" title="å‰ / åç«¯äº¤äº’åŸç†"></a>å‰ / åç«¯äº¤äº’åŸç†</h4><ul>
<li>Web ç¨‹åºçš„å‰åç«¯äº¤äº’åŸç†å¦‚å›¾ 4-2 æ‰€ç¤ºã€‚</li>
</ul>
<p><img src="/images/illustration/Programme/2019/02/django_1-2.jpg" alt="django_1-2"></p>
<center>å›¾ 1-2 Web ç¨‹åºçš„å‰åç«¯äº¤äº’åŸç†</center>

<h4 id="åŸç”Ÿä»£ç æ“ä½œæ•°æ®"><a href="#åŸç”Ÿä»£ç æ“ä½œæ•°æ®" class="headerlink" title="åŸç”Ÿä»£ç æ“ä½œæ•°æ®"></a>åŸç”Ÿä»£ç æ“ä½œæ•°æ®</h4><ul>
<li>Python çš„ MySQL é©±åŠ¨æœ‰ <code>MySQLdb</code>ã€<code>PyMySQL</code> ä»¥åŠ <code>MySQLClient</code>ã€‚</li>
<li><p>åœ¨ Python 2.7 ç‰ˆæœ¬ï¼Œä¸»è¦æ˜¯ç”¨ MySQLdbï¼Œè€Œ Python 3.x ç‰ˆæœ¬å¤šæ•°ä½¿ç”¨ PyMySQL ä»¥åŠ MySQLClientã€‚ä¸¤è€…æ“ä½œé£æ ¼ç±»ä¼¼ï¼Œæœ¬æ–‡åˆ™ä»¥ PyMySQL å±•å¼€æ¢è®¨ã€‚</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°è£…è¿æ¥æ•°æ®åº“çš„ä¿¡æ¯</span></span><br><span class="line">db_infos = &#123;</span><br><span class="line">	<span class="string">'host'</span>: <span class="string">"IP åœ°å€"</span>,</span><br><span class="line">	<span class="string">'port'</span>: <span class="number">3306</span>,</span><br><span class="line">	<span class="string">'user'</span>: <span class="string">"æ•°æ®åº“è´¦æˆ·"</span>,</span><br><span class="line">	<span class="string">'password'</span>: <span class="string">"æ•°æ®åº“å¯†ç "</span>,</span><br><span class="line">	<span class="string">'db'</span>: <span class="string">"æ•°æ®åº“åç§°"</span>,</span><br><span class="line">	<span class="string">'charset'</span>: <span class="string">"utf8"</span>,</span><br><span class="line">	<span class="string">'cursorclass'</span>: pymysql.cursors.DictCursor</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line">db = pymysql.connect(db_infos)</span><br><span class="line"></span><br><span class="line">SQL = <span class="string">"SELECT * FROM t_student"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">	<span class="keyword">with</span> db.cursor() <span class="keyword">as</span> cursor:</span><br><span class="line">		cursor.excute(SQL) <span class="comment"># æ‰§è¡Œ SQL è¯­å¥</span></span><br><span class="line">		db.commit() <span class="comment"># æäº¤ä¿®æ”¹æ•°æ®è¯·æ±‚</span></span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">	db.rollback() <span class="comment"># å›æ»š</span></span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">	db.close() <span class="comment"># å…³é—­æ•°æ®åº“è¿æ¥</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="Ajax-æ–¹å¼äº¤äº’æ•°æ®"><a href="#Ajax-æ–¹å¼äº¤äº’æ•°æ®" class="headerlink" title="Ajax æ–¹å¼äº¤äº’æ•°æ®"></a>Ajax æ–¹å¼äº¤äº’æ•°æ®</h4><ul>
<li><p>å€ŸåŠ© Ajaxï¼Œå®ç°æ•°æ®çš„æœ¬åœ°åˆ·æ–°ï¼Œè€Œä¸éœ€è¦é‡æ–°åŠ è½½ã€æ¸²æŸ“ç½‘é¡µã€‚</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    url: <span class="string">'æäº¤åœ°å€'</span>,</span><br><span class="line">    type: <span class="string">'POST'</span> <span class="comment">// POST / GET</span></span><br><span class="line">    data: &#123;<span class="string">'key_1'</span>: <span class="string">'value_1'</span>, ..., <span class="string">'key_n'</span>: <span class="string">'value_n'</span> &#125;</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="comment">// å½“å‰æœåŠ¡ç«¯å¤„ç†æ•°æ®ï¼Œè‡ªåŠ¨æ‰§è¡Œå›è°ƒå‡½æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="æ¡†æ¶æ­£æ–‡"><a href="#æ¡†æ¶æ­£æ–‡" class="headerlink" title="æ¡†æ¶æ­£æ–‡"></a>æ¡†æ¶æ­£æ–‡</h2><p>æœ¬ç« èŠ‚çš„å†…å®¹å‚è€ƒ <a href="https://docs.djangoproject.com/zh-hans/2.1/" target="_blank" rel="noopener">Django å®˜æ–¹æ–‡æ¡£ v2.1</a> æ•´ç†æ‰€å¾—ï¼Œå³æŠŠæ¨¡å‹ã€æ¨¡æ¿å’Œè§†å›¾çš„æ¦‚å¿µæ›´åŠ ç»†åŒ–ï¼Œé€šè¿‡ä¸€ä¸ªæŠ•ç¥¨åº”ç”¨çš„å®ä¾‹ä»¥è®²è¿°å¦‚ä½•æ­å»ºä¸€ä¸ª <code>MTVæ¨¡å¼</code> çš„ Web æ¡†æ¶ï¼Œå¦‚å›¾ 3-1 æ‰€ç¤ºã€‚</p>
<p><img src="/images/illustration/Programme/2019/02/django_2-1.jpg" alt="django_2-1"></p>
<center>å›¾ 2-1 MTV æ¨¡å¼çš„ Web æ¡†æ¶</center>

<h3 id="æ•°æ®åº“é…ç½®"><a href="#æ•°æ®åº“é…ç½®" class="headerlink" title="æ•°æ®åº“é…ç½®"></a>æ•°æ®åº“é…ç½®</h3><ul>
<li><p>ç¼–è¾‘ <code>mysite/settings.py</code> æ–‡ä»¶å‰ï¼Œå…ˆè®¾ç½® <a href="https://docs.djangoproject.com/zh-hans/2.1/ref/settings/#std:setting-TIME_ZONE" target="_blank" rel="noopener">TIME_ZONE</a> ä¸ºä½ è‡ªå·±æ—¶åŒºï¼Œå¯å‚è€ƒ Wikipedia çš„ <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" target="_blank" rel="noopener">List of time zones</a>ã€‚</p>
<blockquote>
<p>æ–°å»ºç«‹çš„é¡¹ç›®ï¼Œé»˜è®¤æ—¶åŒºä¸º <code>UTC</code>ã€‚</p>
</blockquote>
</li>
<li><p>æ‰“å¼€ <code>mysite/settings.py</code>ï¼Œé€šå¸¸è¿™ä¸ªé…ç½®æ–‡ä»¶ä½¿ç”¨ SQLite ä½œä¸ºé»˜è®¤æ•°æ®åº“ã€‚</p>
<ul>
<li><code>ENGINE</code>ï¼šé€‰å€¼ <code>django.db.backends.sqlite3</code>ã€‚</li>
<li><p><code>NAME</code>ï¼šæ•°æ®åº“çš„åç§°ã€‚è‹¥ä½¿ç”¨ <a href="https://baike.baidu.com/item/SQLite/375020?fr=aladdin" target="_blank" rel="noopener">SQLite</a>ï¼Œæ•°æ®åº“å°†æ˜¯ä½ ç”µè„‘ä¸Šçš„ä¸€ä¸ªæ–‡ä»¶ï¼ŒNAME åº”è¯¥æ˜¯æ­¤æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ + æ–‡ä»¶åï¼Œé»˜è®¤å€¼ <code>os.path.join(BASE_DIR, &#39;db.sqlite3&#39;)</code> å°†ä¼šæŠŠæ•°æ®åº“æ–‡ä»¶å‚¨å­˜åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ã€‚</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">'default'</span>: &#123;</span><br><span class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.sqlite3'</span>,</span><br><span class="line">        <span class="string">'NAME'</span>: os.path.join(BASE_DIR, <span class="string">'db.sqlite3'</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è‹¥ä½¿ç”¨äº† SQLite ä»¥å¤–çš„æ•°æ®åº“ï¼Œè¯·ç¡®è®¤åœ¨ä½¿ç”¨å‰å·²ç» <code>åˆ›å»ºäº†æ•°æ®åº“</code>ã€‚è¿æ¥åˆ°å…¶ä»–æ•°æ®åº“æ—¶ ( MySQLï¼ŒOracle æˆ– PostgreSQL )ï¼Œå‚è€ƒ <a href="https://docs.djangoproject.com/zh-hans/2.1/ref/settings/#std:setting-DATABASE-ENGINE" target="_blank" rel="noopener">ENGINE</a> çš„è®¾ç½®æ¥è¿æ¥å…¶ä»–æ•°æ®åº“ã€‚ä¾‹å¦‚è¿æ¥ MySQL çš„é…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">'default'</span>: &#123;</span><br><span class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.mysql'</span>,</span><br><span class="line">        <span class="string">'NAME'</span>: <span class="string">'mydatabase'</span>,</span><br><span class="line">        <span class="string">'USER'</span>: <span class="string">'mydatabaseuser'</span>,</span><br><span class="line">        <span class="string">'PASSWORD'</span>: <span class="string">'mypassword'</span>,</span><br><span class="line">        <span class="string">'HOST'</span>: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">        <span class="string">'PORT'</span>: <span class="string">'3306'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>æ­¤å¤–ï¼Œå…³æ³¨ä¸€ä¸‹æ–‡ä»¶å¤´éƒ¨çš„ <code>INSTALLED_APPS</code> è®¾ç½®é¡¹ã€‚è¿™é‡ŒåŒ…æ‹¬äº†é¡¹ç›®ä¸­å¯ç”¨çš„æ‰€æœ‰ Django åº”ç”¨ã€‚åº”ç”¨èƒ½åœ¨å¤šä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥æ‰“åŒ…å¹¶ä¸”å‘å¸ƒåº”ç”¨ï¼Œè®©åˆ«äººä½¿ç”¨å®ƒä»¬ã€‚é€šå¸¸ INSTALLED_APPS é»˜è®¤åŒ…æ‹¬äº†ä»¥ä¸‹ Django çš„è‡ªå¸¦åº”ç”¨ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="comment"># å› ä¸º ApplicationConfig ç±»å†™åœ¨æ–‡ä»¶ polls/apps.py ä¸­ï¼Œ</span></span><br><span class="line">    <span class="comment"># æ‰€ä»¥å®ƒçš„ç‚¹å¼è·¯å¾„æ˜¯ 'polls.apps.ApplicationConfig'</span></span><br><span class="line">    <span class="string">'polls.apps.ApplicationConfig'</span>,	<span class="comment"># æ¿€æ´»æ¨¡å‹</span></span><br><span class="line">    <span class="string">'django.contrib.admin'</span>,		<span class="comment"># ç®¡ç†å‘˜ç«™ç‚¹</span></span><br><span class="line">    <span class="string">'django.contrib.auth'</span>,		<span class="comment"># è®¤è¯æˆæƒç³»ç»Ÿ</span></span><br><span class="line">    <span class="string">'django.contrib.contenttypes'</span>,	<span class="comment"># å†…å®¹ç±»å‹æ¡†æ¶</span></span><br><span class="line">    <span class="string">'django.contrib.sessions'</span>,		<span class="comment"># ä¼šè¯æ¡†æ¶</span></span><br><span class="line">    <span class="string">'django.contrib.messages'</span>,		<span class="comment"># æ¶ˆæ¯æ¡†æ¶</span></span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,	<span class="comment"># ç®¡ç†é™æ€æ–‡ä»¶çš„æ¡†æ¶</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>é»˜è®¤å¼€å¯çš„æŸäº›åº”ç”¨éœ€è¦è‡³å°‘ä¸€ä¸ªæ•°æ®è¡¨ï¼Œæ•…åœ¨ä½¿ç”¨ä»–ä»¬å‰éœ€è¦åœ¨æ•°æ®åº“ä¸­åˆ›å»ºä¸€äº›è¡¨ã€‚è¯·æ‰§è¡Œå‘½ä»¤ï¼š</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> MacOS / Linux</span></span><br><span class="line">python manage.py migrate</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Windows ( ä¸‹è¿°ä»£ç åŒç†ï¼ŒåŸºæœ¬ä¸Š <span class="string">"py"</span> å¯¹åº”äº <span class="string">"python"</span> )</span></span><br><span class="line">py manage.py migrate</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="æ¨¡å‹å’Œç«™ç‚¹ç®¡ç†"><a href="#æ¨¡å‹å’Œç«™ç‚¹ç®¡ç†" class="headerlink" title="æ¨¡å‹å’Œç«™ç‚¹ç®¡ç†"></a>æ¨¡å‹å’Œç«™ç‚¹ç®¡ç†</h3><h4 id="åˆ›å»ºæ¨¡å‹"><a href="#åˆ›å»ºæ¨¡å‹" class="headerlink" title="åˆ›å»ºæ¨¡å‹"></a>åˆ›å»ºæ¨¡å‹</h4><ul>
<li><p>å®šä¹‰æ¨¡å‹ ( Model )ï¼Œå³æ•°æ®åº“ç»“æ„è®¾è®¡å’Œé™„åŠ çš„å…¶å®ƒå…ƒæ•°æ®ã€‚åœ¨ Django ä¸­ï¼Œä½ åªéœ€è¦å®šä¹‰æ•°æ®æ¨¡å‹ï¼Œå…¶ä¸­çš„å®ç°ä»£ç ä¸ç”¨ç†ä¼šï¼Œå®ƒä»¬ä¼šè‡ªåŠ¨ä»æ¨¡å‹ç”Ÿæˆã€‚</p>
<blockquote>
<p>æ¨¡å‹æ˜¯çœŸå®æ•°æ®çš„ç®€å•æ˜ç¡®çš„æè¿°ï¼Œå®ƒåŒ…å«äº†å‚¨å­˜çš„æ•°æ®æ‰€å¿…è¦çš„å­—æ®µå’Œè¡Œä¸ºã€‚</p>
</blockquote>
</li>
<li><p>ä¾‹å¦‚ï¼Œåœ¨æœ¬æ¡ˆä¾‹ä¸­ ( æŠ•ç¥¨åº”ç”¨ )ï¼Œéœ€è¦åˆ›å»ºä¸¤ä¸ªæ¨¡å‹ï¼šé—®é¢˜ Question å’Œé€‰é¡¹ Choiceã€‚</p>
<ul>
<li>Question æ¨¡å‹ï¼šåŒ…æ‹¬é—®é¢˜æè¿°å’Œå‘å¸ƒæ—¶é—´ã€‚</li>
<li>Choice æ¨¡å‹ï¼šåŒ…æ‹¬é€‰é¡¹æè¿°å’Œå½“å‰å¾—ç¥¨æ•°ã€‚æ¯ä¸ªé€‰é¡¹å±äºä¸€ä¸ªé—®é¢˜ ( ä¸€å¯¹ä¸€å…³ç³» )ã€‚</li>
</ul>
</li>
<li><p>è¿™äº›æ¦‚å¿µå¯é€šè¿‡ Python ç±»æ¥æè¿°ã€‚æŒ‰ç…§ä¸‹é¢çš„ä¾‹å­æ¥ç¼–è¾‘ <code>polls/models.py</code> æ–‡ä»¶ï¼š</p>
<ul>
<li>æ¯ä¸ªæ¨¡å‹è¢«è¡¨ç¤ºä¸º <code>django.db.models.Model</code> ç±»çš„å­ç±»ã€‚æ¯ä¸ªæ¨¡å‹æœ‰ä¸€äº›ç±»å˜é‡ï¼Œå®ƒä»¬éƒ½è¡¨ç¤ºæ¨¡å‹é‡Œçš„ä¸€ä¸ªæ•°æ®åº“å­—æ®µã€‚</li>
<li>æ¯ä¸ªå­—æ®µéƒ½æ˜¯ <code>Field</code> ç±»çš„å®ä¾‹ï¼Œè¿™å°†å‘Šè¯‰ Django æ¯ä¸ªå­—æ®µè¦å¤„ç†çš„æ•°æ®ç±»å‹ã€‚æ¯”å¦‚ï¼Œå­—ç¬¦å­—æ®µè¢«è¡¨ç¤ºä¸º <code>CharField</code>ï¼Œæ—¥æœŸæ—¶é—´å­—æ®µè¢«è¡¨ç¤ºä¸º <code>DateTimeField</code>ã€‚</li>
<li><p>å®šä¹‰æŸäº› Field ç±»å®ä¾‹éœ€è¦å‚æ•°ï¼Œä¾‹å¦‚ CharField éœ€è¦ä¸€ä¸ª max_length å‚æ•°ã€‚</p>
<blockquote>
<p>è¿™ä¸ªå‚æ•°çš„ç”¨å¤„ä¸æ­¢äºç”¨æ¥å®šä¹‰æ•°æ®åº“ç»“æ„ï¼Œä¹Ÿç”¨äºéªŒè¯æ•°æ®ã€‚</p>
</blockquote>
</li>
<li><p>Django æ”¯æŒæ‰€æœ‰å¸¸ç”¨çš„æ•°æ®åº“å…³ç³»ï¼šä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šå’Œå¤šå¯¹å¤šï¼Œæˆ‘ä»¬ä½¿ç”¨å¤–é”® <code>ForeignKey</code> å®šä¹‰äº†ä¸€ä¸ªå…³ç³»ã€‚ä¾‹å¦‚ï¼Œæ¯ä¸ª Choice å¯¹è±¡éƒ½å…³è”åˆ°ä¸€ä¸ª Question å¯¹è±¡ã€‚</p>
</li>
<li><p>æ•°æ®è¡¨æœ€é‡è¦çš„ <code>ä¸»é”®</code> ä¼šè¢«è‡ªåŠ¨åˆ›å»ºï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Question</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    question_text = models.CharField(max_ length=<span class="number">200</span>)</span><br><span class="line">    pub_date = models.DateTimeField(<span class="string">'date published'</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Question.objects.all() è¿”å›ä¿¡æ¯å¯¹æˆ‘ä»¬ç”¨å¤„ä¸å¤§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;Question: Question object (1)&gt;]&gt;</span></span><br><span class="line">    <span class="comment"># å¯å°è¯•é€šè¿‡ __str__() æ–¹æ³•è¿”å›ä¸€äº›å­—æ®µä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">    	<span class="keyword">return</span> self.question_text</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Choice</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    question = models.ForeignKey(Question, on_delete=models.CASCADE)</span><br><span class="line">    choice_text = models.CharField(max_length=<span class="number">200</span>)</span><br><span class="line">    votes = models.IntegerField(default=<span class="number">0</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">    	<span class="keyword">return</span> self.choice_text</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h4 id="æ¿€æ´»æ¨¡å‹"><a href="#æ¿€æ´»æ¨¡å‹" class="headerlink" title="æ¿€æ´»æ¨¡å‹"></a>æ¿€æ´»æ¨¡å‹</h4><ul>
<li><p>ä»ä¸Šè¿°ç”¨äºåˆ›å»ºæ¨¡å‹çš„ä»£ç å¯çŸ¥ï¼ŒDjango å¯å®ç°ï¼š</p>
<ul>
<li>ä¸ºè¿™ä¸ªåº”ç”¨åˆ›å»ºæ•°æ®åº“ <code>schema</code> ( ç”Ÿæˆ CREATE TABLE è¯­å¥ )ã€‚</li>
<li>åˆ›å»ºä¸ Question å’Œ Choice å¯¹è±¡ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’çš„ <code>API</code> ( Python ç‰ˆæœ¬ )ã€‚</li>
</ul>
</li>
<li><p>ä½†æ˜¯é¦–å…ˆå¾—æŠŠ polls åº”ç”¨å®‰è£…åˆ°æˆ‘ä»¬çš„é¡¹ç›®é‡Œã€‚å…·ä½“åœ°ï¼Œ åœ¨æ–‡ä»¶ <code>mysite/settings.py</code> ä¸­ <code>INSTALLED_APPS</code> å­é¡¹æ·»åŠ ç‚¹å¼è·¯å¾„ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="comment"># å› ä¸º ApplicationConfig ç±»å†™åœ¨æ–‡ä»¶ polls/apps.py ä¸­ï¼Œ</span></span><br><span class="line">    <span class="comment"># æ‰€ä»¥å®ƒçš„ç‚¹å¼è·¯å¾„æ˜¯ 'polls.apps.ApplicationConfig'</span></span><br><span class="line">    <span class="string">'polls.apps.ApplicationConfig'</span>,	<span class="comment"># æ¿€æ´»æ¨¡å‹</span></span><br><span class="line">    <span class="string">'django.contrib.admin'</span>,			<span class="comment"># ç®¡ç†å‘˜ç«™ç‚¹</span></span><br><span class="line">    <span class="string">'django.contrib.auth'</span>,			<span class="comment"># è®¤è¯æˆæƒç³»ç»Ÿ</span></span><br><span class="line">    <span class="string">'django.contrib.contenttypes'</span>,	<span class="comment"># å†…å®¹ç±»å‹æ¡†æ¶</span></span><br><span class="line">    <span class="string">'django.contrib.sessions'</span>,		<span class="comment"># ä¼šè¯æ¡†æ¶</span></span><br><span class="line">    <span class="string">'django.contrib.messages'</span>,		<span class="comment"># æ¶ˆæ¯æ¡†æ¶</span></span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,	<span class="comment"># ç®¡ç†é™æ€æ–‡ä»¶çš„æ¡†æ¶</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç°åœ¨ä½ çš„ Django é¡¹ç›®ä¼šåŒ…å« polls åº”ç”¨ã€‚æ¥ç€é€šè¿‡è¿è¡Œ <code>makemigrations</code> å‘½ä»¤ï¼ŒDjango ä¼šæ£€æµ‹ä½ å¯¹æ¨¡å‹æ–‡ä»¶çš„ä¿®æ”¹ ( åœ¨è¿™ç§æƒ…å†µä¸‹åˆšåˆ›å»ºçš„å¯ç†è§£ä¸ºæœ€æ–°ä¿®æ”¹çš„  )ï¼Œå¹¶ä¸”æŠŠä¿®æ”¹çš„éƒ¨åˆ†å‚¨å­˜ä¸ºä¸€æ¬¡ <code>è¿ç§»</code>ã€‚</p>
<blockquote>
<p>è¿ç§»ï¼šDjango å¯¹äºæ¨¡å‹å®šä¹‰ï¼Œä¹Ÿå°±æ˜¯ä½ çš„æ•°æ®åº“ç»“æ„çš„å˜åŒ–çš„å‚¨å­˜å½¢å¼ã€‚å®ƒä»¬å…¶å®ä¹Ÿåªæ˜¯ä¸€äº›ä½ ç£ç›˜ä¸Šçš„æ–‡ä»¶ã€‚</p>
</blockquote>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations polls</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>Django æœ‰ä¸€ä¸ªè‡ªåŠ¨æ‰§è¡Œ <code>æ•°æ®åº“è¿ç§»</code> å¹¶åŒæ­¥ç®¡ç†ä½ çš„æ•°æ®åº“ç»“æ„çš„å‘½ä»¤ï¼š</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>å½“ç„¶ï¼Œä½ æ˜¯å¦ä¼šå¥½å¥‡ï¼Œè¿ç§»æ˜¯æ€æ ·çš„è¿‡ç¨‹ï¼Œè¿ç§»å‘½ä»¤ä¼šæ‰§è¡Œå“ªäº› SQL è¯­å¥ï¼Ÿé‚£ä¹ˆï¼Œ<code>sqlmigrate</code> å‘½ä»¤æ¥æ”¶ä¸€ä¸ªè¿ç§»çš„åç§°ï¼Œç„¶åè¿”å›å¯¹åº”çš„ SQLã€‚</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> sqlmigrate å‘½ä»¤</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¹¶æ²¡æœ‰çœŸæ­£åœ¨æ•°æ®åº“ä¸­çš„æ‰§è¡Œè¿ç§»ï¼Œå®ƒåªæ˜¯æŠŠå‘½ä»¤è¾“å‡ºåˆ°å±å¹•ä¸Š</span></span><br><span class="line">python manage.py sqlmigrate polls 0001</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>è¾“å…¥ä»¥ä¸Šå‘½ä»¤ï¼Œä½ å°†çœ‹åˆ°å¦‚ä¸‹ç»“æœ ( æ ¼å¼åŒ–è¾“å‡º SQL )ï¼š</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è¾“å‡ºç¤ºä¾‹ä½¿ç”¨çš„æ˜¯ PostgreSQL / MySQL --</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="comment">-- Create model Choice</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">"polls_choice"</span> (</span><br><span class="line">    <span class="string">"id"</span> <span class="built_in">serial</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    <span class="string">"choice_text"</span> <span class="built_in">varchar</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">"votes"</span> <span class="built_in">integer</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- Create model Question</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">"polls_question"</span> (</span><br><span class="line">    <span class="string">"id"</span> <span class="built_in">serial</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    <span class="string">"question_text"</span> <span class="built_in">varchar</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">"pub_date"</span> <span class="built_in">timestamp</span> <span class="keyword">with</span> <span class="built_in">time</span> zone <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- çœç•¥å‰©ä½™è¯­å¥ï¼Œå…·ä½“å¯è‡ªè¡Œæµ‹è¯• --</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä»æ ¼å¼åŒ–çš„ SQL è¯­å¥å¯æ³¨æ„åˆ°ï¼š</p>
<ul>
<li><p>æ•°æ®åº“çš„è¡¨åæ˜¯ç”±åº”ç”¨å ( polls ) å’Œæ¨¡å‹åçš„å°å†™å½¢å¼ ( question å’Œ choice ) è¿æ¥è€Œæ¥ã€‚</p>
</li>
<li><p>ä¸»é”® ( id ) ä¼šè¢«è‡ªåŠ¨åˆ›å»ºï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚</p>
</li>
<li><p>é»˜è®¤ Django ä¼šåœ¨å¤–é”®å­—æ®µååè¿½åŠ å­—ç¬¦ä¸² â€œ_idâ€ ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚</p>
</li>
<li><p>ç”Ÿæˆçš„ SQL è¯­å¥æ˜¯ä¸ºä½ æ‰€ç”¨çš„æ•°æ®åº“å®šåˆ¶çš„ï¼Œæ‰€ä»¥é‚£äº›å’Œæ•°æ®åº“æœ‰å…³çš„å­—æ®µç±»å‹ï¼Œæ¯”å¦‚ auto_increment ( MySQL )ã€ serial ( PostgreSQL ) å’Œ integer primary key autoincrement ( SQLite )ï¼ŒDjango ä¼šå¸®ä½ è‡ªåŠ¨å¤„ç†ã€‚é‚£äº›å’Œå¼•å·ç›¸å…³çš„äº‹æƒ…ï¼Œæ¯”å¦‚ä½¿ç”¨å•å¼•å·è¿˜æ˜¯åŒå¼•å·ï¼Œä¹Ÿä¸€æ ·ä¼šè¢«è‡ªåŠ¨å¤„ç†ã€‚</p>
</li>
</ul>
</li>
<li><p>æ€»ç»“ï¼šè¿ç§»æ˜¯éå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œå®ƒèƒ½è®©ä½ åœ¨å¼€å‘è¿‡ç¨‹ä¸­æŒç»­çš„æ”¹å˜æ•°æ®åº“ç»“æ„è€Œä¸éœ€è¦é‡æ–°åˆ é™¤å’Œåˆ›å»ºè¡¨ï¼Œå³å®ƒä¸“æ³¨äºä½¿æ•°æ®åº“å¹³æ»‘å‡çº§è€Œä¸ä¼šä¸¢å¤±æ•°æ®ã€‚<strong>ç°åœ¨æ”¹å˜æ¨¡å‹åªéœ€è¦è®°ä½è¿™ä¸‰æ­¥</strong>ï¼š</p>
<ul>
<li><p>ç¼–è¾‘ <code>models.py</code> æ–‡ä»¶ï¼Œæ”¹å˜æ¨¡å‹ã€‚</p>
</li>
<li><p>è¿è¡Œ <code>python manage.py makemigrations</code> ä¸ºæ¨¡å‹çš„æ”¹å˜ <code>ç”Ÿæˆ</code> è¿ç§»æ–‡ä»¶ã€‚</p>
</li>
<li><p>è¿è¡Œ <code>python manage.py migrate</code> æ¥ <code>åº”ç”¨</code> æ•°æ®åº“è¿ç§»ã€‚</p>
</li>
</ul>
</li>
</ul>
<h4 id="æ•°æ®æ“ä½œ"><a href="#æ•°æ®æ“ä½œ" class="headerlink" title="æ•°æ®æ“ä½œ"></a>æ•°æ®æ“ä½œ</h4><ul>
<li>å½“å®Œæˆ <code>åˆ›å»ºæ¨¡å‹</code> ( å®šä¹‰æ•°æ®å®ä½“å’Œæ•°æ®å…³ç³» ) ä¸ <code>æ¿€æ´»æ¨¡å‹</code> ( æ¨¡å‹é©±åŠ¨è‡ªåŠ¨ç”Ÿæˆ SQL ä»£ç  ) çš„å·¥ä½œï¼Œå³è¡¨æ˜æ•°æ®è¡¨å·²å»ºç«‹èµ·æ¥ï¼Œç´§æ¥ç€ä¾¿å¯æ“ä½œæ•°æ®åº“äº†ã€‚</li>
<li>å…³äºæ“ä½œæ•°æ®åº“çš„ Python API æ‰€æœ‰ç»†èŠ‚å¯åœ¨ <a href="https://docs.djangoproject.com/zh-hans/2.1/topics/db/queries/" target="_blank" rel="noopener">Database API For Python</a> å‚è€ƒæ–‡æ¡£ä¸­æ‰¾åˆ°ã€‚</li>
</ul>
<h5 id="åˆ›å»ºå¯¹è±¡"><a href="#åˆ›å»ºå¯¹è±¡" class="headerlink" title="åˆ›å»ºå¯¹è±¡"></a>åˆ›å»ºå¯¹è±¡</h5><ul>
<li><p>å‡è®¾æ¨¡å‹å­˜åœ¨äºæ–‡ä»¶ä¸­ mysite/polls/models.pyï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> polls.models <span class="keyword">import</span> Choice, Question</span><br><span class="line"><span class="comment"># ä½¿ç”¨æ¨¡å‹ç±»çš„å…³é”®å­—å‚æ•°å¯¹å…¶å®ä¾‹åŒ–ï¼Œå†è°ƒç”¨ save() ä»¥å°†å…¶ä¿å­˜åˆ°æ•°æ®åº“ä¸­</span></span><br><span class="line">q = Question(question_text=<span class="string">"What's new?"</span>, pub_date=timezone.now())</span><br><span class="line"><span class="comment"># åˆ›å»ºå’Œä¿å­˜å¯¹è±¡åˆ™ä½¿ç”¨ create() æ–¹æ³•</span></span><br><span class="line">q.save()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="æ›´æ–°å¯¹è±¡"><a href="#æ›´æ–°å¯¹è±¡" class="headerlink" title="æ›´æ–°å¯¹è±¡"></a>æ›´æ–°å¯¹è±¡</h5><ul>
<li><p>UPDATE åœ¨å¹•åæ‰§è¡Œ SQL è¯­å¥ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿å­˜å¯¹è±¡çš„æ›´æ”¹</span></span><br><span class="line">q.question = <span class="string">"What do you think about?"</span></span><br><span class="line">q.save()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>ä¿å­˜ ForeignKey å­—æ®µï¼šæ›´æ–° ForeignKey å­—æ®µçš„å·¥ä½œæ–¹å¼ä¸ä¿å­˜æ™®é€šå­—æ®µçš„æ–¹å¼å®Œå…¨ç›¸åŒï¼Œåªéœ€å°†æ­£ç¡®ç±»å‹çš„å¯¹è±¡åˆ†é…ç»™ç›¸å…³å­—æ®µå³å¯ã€‚</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸€èˆ¬æƒ…å†µ pk ( Primary Key ) å’Œ id æ˜¯ä¸€æ ·çš„ï¼Œåªæœ‰ id ä¸æ˜¯ä¸»é”®æ—¶æ‰ä¸ä¸€æ ·</span></span><br><span class="line">choice = Choice.objects.get(pk=<span class="number">1</span>)</span><br><span class="line">question = Question.objects.get(<span class="string">'What do you think about?'</span>)</span><br><span class="line">choice.question = question</span><br><span class="line">choice.save()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>æ›´æ–°ManyToManyField å·¥ä½œçš„æ–¹å¼ç•¥æœ‰ä¸åŒ ï¼šä½¿ç”¨ add() å­—æ®µä¸Šçš„æ–¹æ³•å‘å…³ç³»æ·»åŠ è®°å½•ã€‚</li>
</ul>
<h5 id="æ£€ç´¢å¯¹è±¡"><a href="#æ£€ç´¢å¯¹è±¡" class="headerlink" title="æ£€ç´¢å¯¹è±¡"></a>æ£€ç´¢å¯¹è±¡</h5><ul>
<li><p>ä½¿ç”¨ all() è¿”å›æ‰€æœ‰å¯¹è±¡ï¼šä¾‹å¦‚ï¼Œè¿”å› Question æ•°æ®åº“ä¸­æ‰€æœ‰å¯¹è±¡ã€‚</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">all_question = Question.objects.all()</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>ä½¿ç”¨è¿‡æ»¤å™¨æ£€ç´¢ç‰¹å®šå¯¹è±¡</code>ï¼šè‹¥æˆ‘ä»¬ä»…éœ€è¦é€‰æ‹©æ•´ä¸ªå¯¹è±¡é›†çš„å­é›†ï¼Œåˆ™éœ€è¦å‘ QuerySet æ·»åŠ è¿‡æ»¤æ¡ä»¶ã€‚ä¸¤ç§æœ€å¸¸è§çš„æ”¹è¿›æ–¹æ³•ï¼š</p>
<ul>
<li><code>filter(**kwargs)</code>ï¼šè¿”å› QuerySet åŒ…å«ä¸ç»™å®šæŸ¥æ‰¾å‚æ•°åŒ¹é…çš„æ–°å¯¹è±¡ã€‚</li>
<li><p><code>exclude(**kwargs)</code>ï¼šè¿”å› QuerySet åŒ…å«ä¸ç»™å®šæŸ¥æ‰¾å‚æ•°ä¸åŒ¹é…çš„æ–°å¯¹è±¡ã€‚</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¾‹å¦‚ï¼šè·å– 2018 å¹´é—´æ‰€æœ‰é—®é¢˜è®°å½•</span></span><br><span class="line">Question.objects.filter(pub_date__year=<span class="number">2017</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><code>é“¾æ¥è¿‡æ»¤å™¨</code>ï¼šQuerySet æ£€ç´¢ç»“æœæœ¬èº«ä¹Ÿæ˜¯ QuerySet å¯¹è±¡ï¼Œæ•…å¯ä½¿ç”¨å¤šä¸ªè¿‡æ»¤å™¨ã€‚ä½œç”¨ä¸ <code>å¤šæ¡ä»¶æŸ¥è¯¢</code> ç±»ä¼¼æ•ˆæœã€‚</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¾‹å¦‚ï¼šè·å–ä»¥â€œWhatâ€å¼€å¤´ï¼Œåœ¨ 2018 å¹´ 1 æœˆ 1 æ—¥è‡³å½“å¤©å‰çš„æ‰€æœ‰è®°å½•</span></span><br><span class="line">Question.objects.filter(</span><br><span class="line">	headline__startswith=<span class="string">'What'</span></span><br><span class="line">).exclude(</span><br><span class="line">	pub_date__gte=datetime.date.today()</span><br><span class="line">).filter(</span><br><span class="line">	pub_date__gte=datetime.date(<span class="number">2018</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>ä½¿ç”¨ get() æ£€ç´¢å•ä¸ªå¯¹è±¡ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">one_question = Question.objects.get(pk=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># Question æ²¡æœ‰ä¸»é”®ä¸º 1 çš„å¯¹è±¡ï¼ŒDjango å°†å¼•å‘å¼‚å¸¸ Entry.DoesNotExistã€‚</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>é™åˆ¶ QuerySet è¿”å›é›†åˆçš„å¤§å°ï¼šä½¿ç”¨ Python çš„æ•°ç»„åˆ‡ç‰‡è¯­æ³•å°†é™åˆ¶ QuerySet ä¸ºä¸€å®šæ•°é‡çš„ç»“æœã€‚è¿™ç›¸å½“äº SQL ä¸­ <code>LIMIT</code> å’Œ <code>OFFSET</code> å­å¥ã€‚</p>
<ul>
<li>æ³¨æ„ 1ï¼š<code>Entry.objects.all()[-1]</code> ä¸æ”¯æŒè´Ÿç´¢å¼•ã€‚</li>
<li><p>æ³¨æ„ 2ï¼š<code>Entry.objects.all()[:10:2]</code> ä¸æ”¯æŒä½¿ç”¨æ­¥è¿› ( Step ) å–å€¼ã€‚</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¾‹å¦‚ï¼šè¿”å›å‰5ä¸ªå¯¹è±¡ï¼ˆï¼‰ï¼šLIMIT 5</span></span><br><span class="line">Question.objects.all()[:<span class="number">5</span>]</span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼šè¿”å›ç¬¬6åˆ°ç¬¬10ä¸ªå¯¹è±¡ï¼šOFFSET 5 LIMIT 5</span></span><br><span class="line">Question.objects.all()[<span class="number">5</span>:<span class="number">10</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h4 id="ç«™ç‚¹ç®¡ç†"><a href="#ç«™ç‚¹ç®¡ç†" class="headerlink" title="ç«™ç‚¹ç®¡ç†"></a>ç«™ç‚¹ç®¡ç†</h4><h5 id="å¼€ç¯‡å¼•è¨€"><a href="#å¼€ç¯‡å¼•è¨€" class="headerlink" title="å¼€ç¯‡å¼•è¨€"></a>å¼€ç¯‡å¼•è¨€</h5><ul>
<li>ç›¸ä¿¡ä½ ä¹Ÿæœ‰è¿‡åŒæ ·çš„ç»å†ï¼Œä¾‹å¦‚ä¸ºä½ çš„å‘˜å·¥æˆ–å®¢æˆ·ç”Ÿæˆä¸€ä¸ªç”¨æˆ·æ·»åŠ ã€ä¿®æ”¹å’Œåˆ é™¤å†…å®¹çš„ç®¡ç†åå°ï¼Œå³ç®€å•çš„å¢åˆ æ”¹æŸ¥æ“ä½œ ( CRUD ) ï¼Œä½†å®ƒå´æ˜¯ä¸€é¡¹ç¼ºä¹åˆ›é€ æ€§å’Œä¹å‘³çš„å·¥ä½œã€‚å› æ­¤ï¼ŒDjango å…¨è‡ªåŠ¨åœ°æ ¹æ®æ¨¡å‹åˆ›å»ºç•Œé¢åŒ–çš„ç®¡ç†åå°ã€‚</li>
<li>ç®¡ç†ç•Œé¢ä¸æ˜¯ä¸ºäº†ç½‘ç«™çš„è®¿é—®è€…ï¼Œè€Œæ˜¯ä¸ºç®¡ç†è€…å‡†å¤‡çš„ã€‚éœ€è¦å®¢åˆ¶åŒ–çš„åå°ç®¡ç†ç•Œé¢è¿˜éœ€è‡ªè¡Œå®ç°ã€‚</li>
</ul>
<h5 id="åˆ›å»ºç®¡ç†å‘˜è´¦å·"><a href="#åˆ›å»ºç®¡ç†å‘˜è´¦å·" class="headerlink" title="åˆ›å»ºç®¡ç†å‘˜è´¦å·"></a>åˆ›å»ºç®¡ç†å‘˜è´¦å·</h5><ul>
<li><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¾—åˆ›å»ºä¸€ä¸ªèƒ½ç™»å½•ç®¡ç†é¡µé¢çš„ç”¨æˆ·ã€‚è¯·è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python manage.py createsuperuser</span><br><span class="line"><span class="comment"># Username: kofe</span></span><br><span class="line"><span class="comment"># Email address: kofe@example.com</span></span><br><span class="line"><span class="comment"># Password: **********</span></span><br><span class="line"><span class="comment"># Password (again): *********</span></span><br><span class="line"><span class="comment"># Superuser created successfully.</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="å¯åŠ¨å¼€å‘æœåŠ¡å™¨"><a href="#å¯åŠ¨å¼€å‘æœåŠ¡å™¨" class="headerlink" title="å¯åŠ¨å¼€å‘æœåŠ¡å™¨"></a>å¯åŠ¨å¼€å‘æœåŠ¡å™¨</h5><ul>
<li><p>Django çš„ç®¡ç†ç•Œé¢é»˜è®¤å°±æ˜¯å¯ç”¨çš„ã€‚è®©æˆ‘ä»¬å¯åŠ¨å¼€å‘æœåŠ¡å™¨ã€‚å½“ç„¶ï¼Œä½ å¯ä»¥é€šè¿‡ PyCharm å¯åŠ¨æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤å¯åŠ¨ï¼š</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ‰“å¼€æµè§ˆå™¨å³å¯è®¿é—®ï¼š<code>http://127.0.0.1:8000/admin/</code></p>
</li>
</ul>
<h5 id="ç®¡ç†é¡µæ·»åŠ åº”ç”¨"><a href="#ç®¡ç†é¡µæ·»åŠ åº”ç”¨" class="headerlink" title="ç®¡ç†é¡µæ·»åŠ åº”ç”¨"></a>ç®¡ç†é¡µæ·»åŠ åº”ç”¨</h5><ul>
<li><p>åœ¨ç´¢å¼•é¡µé¢ä¸­ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰çœ‹åˆ°åº”ç”¨ï¼Œå¦‚æœ¬ä¾‹ä¸­çš„æŠ•ç¥¨åº”ç”¨ <code>polls</code>ã€‚æ‰€ä»¥æˆ‘ä»¬å¾—å‘Šè¯‰ç®¡ç†é¡µé¢ï¼Œé—®é¢˜ <code>Question</code> å¯¹è±¡éœ€è¦è¢«ç®¡ç†ã€‚æ‰“å¼€ <code>polls/admin.py</code> æ–‡ä»¶ï¼ŒæŠŠå®ƒç¼–è¾‘æˆä¸‹é¢è¿™æ ·ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Question</span><br><span class="line">admin.site.register(Question)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="æ¨¡æ¿å’Œè§†å›¾"><a href="#æ¨¡æ¿å’Œè§†å›¾" class="headerlink" title="æ¨¡æ¿å’Œè§†å›¾"></a>æ¨¡æ¿å’Œè§†å›¾</h3><h4 id="å¼€ç¯‡å¼•è¨€-1"><a href="#å¼€ç¯‡å¼•è¨€-1" class="headerlink" title="å¼€ç¯‡å¼•è¨€"></a>å¼€ç¯‡å¼•è¨€</h4><ul>
<li><p>æ¯ä¸ªè§†å›¾å¿…é¡»è¦åšçš„åªæœ‰ä¸¤ä»¶äº‹ï¼šè¿”å›ä¸€ä¸ªåŒ…å«è¢«è¯·æ±‚é¡µé¢å†…å®¹çš„ <code>HttpResponse</code> å¯¹è±¡æˆ–è€…æŠ›å‡ºä¸€ä¸ª <code>å¼‚å¸¸</code>ï¼Œæ¯”å¦‚ HTTP 404ã€‚</p>
<blockquote>
<p>Django åªè¦æ±‚è¿”å›çš„æ˜¯ä¸€ä¸ª HttpResponse ï¼Œæˆ–æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚</p>
</blockquote>
</li>
<li><p>è§†å›¾å¯ä»¥ä»æ•°æ®åº“é‡Œè¯»å–è®°å½•ï¼Œå¯ä½¿ç”¨ä¸€ä¸ªæ¨¡æ¿å¼•æ“ ( Django è‡ªå¸¦æˆ–è€…å…¶ä»–ç¬¬ä¸‰æ–¹çš„ )ï¼Œç”Ÿæˆä¸€ä¸ª PDF æ–‡ä»¶ã€è¾“å‡ºä¸€ä¸ª XMLã€åˆ›å»ºä¸€ä¸ª ZIP æ–‡ä»¶ç­‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»»ä½•ä½ æƒ³ç”¨çš„ Python åº“ï¼Œå®ç°ä½ æƒ³åšçš„äº‹ã€‚</p>
</li>
<li><p>Django è‡ªå¸¦çš„ <a href="https://docs.djangoproject.com/zh-hans/2.1/topics/db/queries/" target="_blank" rel="noopener">Database API</a> å¾ˆæ–¹ä¾¿ï¼Œä¸è¯•å›¾ç»“åˆä½¿ç”¨å³å¯å®ç°æ•°æ®çš„åŸºæœ¬äº¤äº’æ“ä½œã€‚</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨ index() å‡½æ•°é‡Œæ’å…¥äº†ä¸€äº›æ–°å†…å®¹</span></span><br><span class="line"><span class="comment"># è®©å®ƒèƒ½å±•ç¤ºæ•°æ®åº“é‡Œä»¥å‘å¸ƒæ—¥æœŸæ’åºçš„æœ€è¿‘5ä¸ªæŠ•ç¥¨é—®é¢˜</span></span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Question</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></span><br><span class="line">	latest_question_list = Question.objects.order_by(<span class="string">'-pub_date'</span>)[<span class="number">0</span>:<span class="number">5</span>]</span><br><span class="line">	output = <span class="string">', '</span>.join([q.question_text <span class="keyword">for</span> q <span class="keyword">in</span> latest_question_list])</span><br><span class="line">	<span class="keyword">return</span> HttpResponse(output)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="æ¨¡æ¿ç³»ç»Ÿ"><a href="#æ¨¡æ¿ç³»ç»Ÿ" class="headerlink" title="æ¨¡æ¿ç³»ç»Ÿ"></a>æ¨¡æ¿ç³»ç»Ÿ</h4><ul>
<li><p>è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼šé¡µé¢çš„è®¾è®¡å†™æ­»åœ¨è§†å›¾å‡½æ•°çš„ä»£ç é‡Œçš„ã€‚å¦‚æœä½ æƒ³æ”¹å˜é¡µé¢çš„æ ·å­ï¼Œä½ éœ€è¦ç¼–è¾‘ Python ä»£ç ã€‚æˆ‘ä»¬æ˜¯å¦èƒ½å°†æ­¤è¿‡ç¨‹ç›¸äº’åˆ†ç¦»ï¼Œå³ <code>è§†å›¾è´Ÿè´£å¤„ç†ã€ç»„è£…æ•°æ®</code>ï¼›<code>æ¨¡æ¿åˆ™è´Ÿè´£æ ·å¼</code>ã€‚</p>
<ul>
<li>é¦–å…ˆï¼Œåœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•é‡Œåˆ›å»ºä¸€ä¸ª <code>templates</code> ç›®å½•ã€‚Django å°†ä¼šåœ¨è¿™ä¸ªç›®å½•é‡ŒæŸ¥æ‰¾æ¨¡æ¿æ–‡ä»¶ã€‚</li>
<li>åœ¨ <code>templates</code> ç›®å½•é‡Œï¼Œå†åˆ›å»ºä¸€ä¸ªç›®å½• <code>polls</code>ï¼Œç„¶ååœ¨å…¶ä¸­æ–°å»ºä¸€ä¸ªæ–‡ä»¶ <code>index.html</code>ã€‚</li>
<li><p>æ¢å¥è¯è¯´ï¼Œä½ çš„æ¨¡æ¿æ–‡ä»¶çš„è·¯å¾„åº”è¯¥æ˜¯ <code>mysite/templates/polls/index.html</code>ã€‚å› ä¸º Django ä¼šå¯»æ‰¾åˆ°å¯¹åº”çš„ <code>app_directories</code>ï¼Œæ‰€ä»¥ä½ åªéœ€è¦ä½¿ç”¨ <code>polls/index.html</code> å°±å¯å¼•ç”¨åˆ°è¿™ä¸€æ¨¡æ¿äº†ã€‚</p>
<blockquote>
<p><code>æ¨¡æ¿å‘½åç©ºé—´</code>ï¼šè™½ç„¶å¯å°†æ¨¡æ¿æ–‡ä»¶ç›´æ¥æ”¾åœ¨ mysite/templates ç›®å½•ä¸‹ï¼Œä½†è‹¥æœ‰ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶æ­£å¥½å’Œå¦ä¸€ä¸ªåº”ç”¨ä¸­çš„æŸä¸ªæ¨¡æ¿æ–‡ä»¶é‡åï¼Œåˆ™ Django æ²¡æœ‰åŠæ³•åŒºåˆ†å®ƒä»¬ï¼Œä»è€Œé€‰æ‹©ç¬¬ä¸€ä¸ªåŒ¹é…çš„æ¨¡æ¿æ–‡ä»¶ï¼Œé€ æˆä¸èƒ½å‡†ç¡®åŒ¹é…çš„çŠ¶å†µã€‚</p>
<p>å¸®åŠ© Django æ­£ç¡®é€‰æ‹©æ¨¡æ¿ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯æŠŠä»–ä»¬æ”¾å…¥å„è‡ªçš„ <code>å‘½åç©ºé—´</code> ä¸­ï¼Œå³æŠŠè¿™äº›æ¨¡æ¿æ”¾å…¥ä¸€ä¸ªå’Œ <code>è‡ªèº«åº”ç”¨é‡å</code> çš„å­æ–‡ä»¶å¤¹é‡Œï¼Œå¦‚æœ¬ä¾‹ä¸­çš„ <code>polls</code>ã€‚</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h4 id="å°è¯•ç‰›åˆ€"><a href="#å°è¯•ç‰›åˆ€" class="headerlink" title="å°è¯•ç‰›åˆ€"></a>å°è¯•ç‰›åˆ€</h4><ul>
<li><p>æˆ‘ä»¬å°†ä¸‹é¢çš„ä»£ç è¾“å…¥åˆ°åˆšåˆšåˆ›å»ºçš„æ¨¡æ¿æ–‡ä»¶ä¸­ï¼š</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- mysite/templates/polls/index.html --&gt;</span></span><br><span class="line">&#123;% if latest_question_list %&#125;</span><br><span class="line">	<span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">	&#123;% for question in latest_question_list %&#125;</span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/polls/&#123;&#123; question.id &#125;&#125;/"</span>&gt;</span></span><br><span class="line">			&#123;&#123; question.question_text &#125;&#125;</span><br><span class="line">		<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	&#123;% endfor %&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">&#123;% else %&#125;</span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>No polls are available.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>ç„¶åï¼Œè®©æˆ‘ä»¬æ›´æ–°ä¸€ä¸‹ polls/views.py é‡Œçš„ index è§†å›¾æ¥ä½¿ç”¨æ¨¡æ¿ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"><span class="keyword">from</span> django.template <span class="keyword">import</span> loader</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Question</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></span><br><span class="line">	latest_question_list = Question.objects.order_by(<span class="string">'-pub_date'</span>)[:<span class="number">5</span>]</span><br><span class="line">	template = loader.get_template(<span class="string">'polls/index.html'</span>)</span><br><span class="line">	context = &#123;</span><br><span class="line">		<span class="string">'latest_question_list'</span>: latest_question_list,</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> HttpResponse(template.render(context, request))</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>è½½å…¥æ¨¡æ¿ï¼Œå¡«å……ä¸Šä¸‹æ–‡ï¼Œå†è¿”å›ç”±å®ƒç”Ÿæˆçš„ HttpResponse å¯¹è±¡ï¼Œè¿™é‡Œå¼•å…¥ä¸€ä¸ªä¾¿æ·å‡½æ•° render() å‡½æ•°ã€‚å®ƒå·²ç»æŠŠæ­¤è¿‡ç¨‹å°è£…ä¸€èµ·ï¼Œè°ƒç”¨å³å¯ä½¿ç”¨ã€‚</p>
<p>  render() å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ request å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ¨¡æ¿åï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å­—å…¸ã€‚å®ƒè¿”å›ç»™å®šä¸Šä¸‹æ–‡å‘ˆç°çš„ç»™å®šæ¨¡æ¿çš„ HttpResponse å¯¹è±¡ã€‚</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></span><br><span class="line">	latest_question_list = Question.objects.order_by(<span class="string">'-pub_date'</span>)[:<span class="number">5</span>]</span><br><span class="line">	context = &#123;<span class="string">'latest_question_list'</span>: latest_question_list&#125;</span><br><span class="line">	<span class="keyword">return</span> render(request, <span class="string">'polls/index.html'</span>, context)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>ç”¨ä½ çš„æµè§ˆå™¨è®¿é—® <code>http://127.0.0.1:8000/polls/</code>ï¼Œä½ å°†ä¼šçœ‹è§ä¸€ä¸ªæ— åºåˆ—è¡¨ã€‚</li>
</ul>
<h4 id="ä½¿ç”¨æ¨¡æ¿ç³»ç»Ÿ"><a href="#ä½¿ç”¨æ¨¡æ¿ç³»ç»Ÿ" class="headerlink" title="ä½¿ç”¨æ¨¡æ¿ç³»ç»Ÿ"></a>ä½¿ç”¨æ¨¡æ¿ç³»ç»Ÿ</h4><blockquote>
<p>ä½¿ç”¨æ¨¡æ¿ç³»ç»Ÿçš„è¿‡ç¨‹ï¼Œæ›´åƒæ˜¯å‰ç«¯ä¸åç«¯ä¿¡æ¯äº¤äº’çš„è¿‡ç¨‹ï¼Œå³å‰ç«¯è®¿é—®è¯·æ±‚åœ°å€è·å–æ•°æ®çš„è¿‡ç¨‹ã€‚</p>
</blockquote>
<ul>
<li>æ¨¡æ¿ç³»ç»Ÿç»Ÿä¸€ä½¿ç”¨ <code>ç‚¹ç¬¦å·</code> æ¥è®¿é—®å˜é‡çš„å±æ€§ã€‚åœ¨ç¤ºä¾‹ {{ question.question_text }} ä¸­ï¼Œé¦–å…ˆ Django å°è¯•å¯¹ question å¯¹è±¡ä½¿ç”¨å­—å…¸æŸ¥æ‰¾ ( ä¹Ÿå°±æ˜¯ä½¿ç”¨ obj.get(str) æ“ä½œ )ï¼Œå¦‚æœå¤±è´¥äº†å°±å°è¯•å±æ€§æŸ¥æ‰¾ ( ä¹Ÿå°±æ˜¯ obj.str æ“ä½œ )ï¼Œç»“æœæ˜¯æˆåŠŸäº†ã€‚å¦‚æœè¿™ä¸€æ“ä½œä¹Ÿå¤±è´¥çš„è¯ï¼Œå°†ä¼šå°è¯•åˆ—è¡¨æŸ¥æ‰¾ ( ä¹Ÿå°±æ˜¯ obj[int] æ“ä½œ )ã€‚</li>
<li>åœ¨{% for %}å¾ªç¯ä¸­å‘ç”Ÿçš„å‡½æ•°è°ƒç”¨ï¼šquestion.choice_set.all è¢«è§£é‡Šä¸º Python ä»£ç  question.choice_set.all()ï¼Œå°†ä¼šè¿”å›ä¸€ä¸ªå¯è¿­ä»£çš„ Choice å¯¹è±¡ï¼Œè¿™ä¸€å¯¹è±¡å¯ä»¥åœ¨ {% for %} æ ‡ç­¾å†…éƒ¨ä½¿ç”¨ã€‚</li>
<li>æŸ¥çœ‹ <a href="https://docs.djangoproject.com/zh-hans/2.1/topics/templates/" target="_blank" rel="noopener">æ¨¡æ¿æŒ‡å—</a> å¯ä»¥äº†è§£å…³äºæ¨¡æ¿çš„æ›´å¤šä¿¡æ¯ã€‚</li>
</ul>
<h4 id="å»é™¤æ¨¡æ¿ä¸­çš„ç¡¬ç¼–ç -URL"><a href="#å»é™¤æ¨¡æ¿ä¸­çš„ç¡¬ç¼–ç -URL" class="headerlink" title="å»é™¤æ¨¡æ¿ä¸­çš„ç¡¬ç¼–ç  URL"></a>å»é™¤æ¨¡æ¿ä¸­çš„ç¡¬ç¼–ç  URL</h4><ul>
<li><p>ç¡¬ç¼–ç ï¼šç¡¬ç¼–ç å’Œå¼ºè€¦åˆçš„é“¾æ¥ï¼Œå¯¹äºä¸€ä¸ªåŒ…å«å¾ˆå¤šåº”ç”¨çš„é¡¹ç›®æ¥è¯´ï¼Œä¿®æ”¹èµ·æ¥æ˜¯ååˆ†å›°éš¾çš„ã€‚</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/polls/&#123;&#123; question.id &#125;&#125;/"</span>&gt;</span></span><br><span class="line">	&#123;&#123; question.question_text &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è½¯ç¼–ç ï¼šç„¶è€Œï¼Œå› ä¸ºä½ åœ¨ polls.urls çš„ url() å‡½æ•°ä¸­é€šè¿‡ name å‚æ•°ä¸º URL å®šä¹‰äº†åå­—ï¼Œä½ å¯ä»¥ä½¿ç”¨ {% url %} æ ‡ç­¾ä»£æ›¿å®ƒã€‚</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> | å…·æœ‰åå­— 'detail' çš„ URL åœ¨ polls/url.py ä¸­å®šä¹‰ä¸ºï¼š</span></span><br><span class="line"><span class="comment"> | path('&lt;int:question_id&gt;/', views.detail, name='detail')</span></span><br><span class="line"><span class="comment">--&gt;</span>	</span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'detail' question.id %&#125;"</span>&gt;</span></span><br><span class="line">	&#123;&#123; question.question_text &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment"> | è‹¥ä½ æƒ³æ”¹å˜æŠ•ç¥¨è¯¦æƒ…è§†å›¾çš„ URLï¼Œæ¯”å¦‚ polls/specifics/12/</span></span><br><span class="line"><span class="comment"> | ä¸ç”¨åœ¨æ¨¡æ¿é‡Œä¿®æ”¹ä»»ä½•ä¸œè¥¿ (åŒ…æ‹¬æ¨¡æ¿)ï¼Œåªåœ¨ polls/urls.py ç¨å¾®ä¿®æ”¹å°±è¡Œ</span></span><br><span class="line"><span class="comment"> | path('specifics/&lt;int:question_id&gt;/', views.detail, name='detail')</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="ä¸º-URL-åç§°æ·»åŠ å‘½åç©ºé—´"><a href="#ä¸º-URL-åç§°æ·»åŠ å‘½åç©ºé—´" class="headerlink" title="ä¸º URL åç§°æ·»åŠ å‘½åç©ºé—´"></a>ä¸º URL åç§°æ·»åŠ å‘½åç©ºé—´</h4><ul>
<li>åœ¨ä¸€ä¸ªçœŸå®çš„ Django é¡¹ç›®ä¸­ï¼Œå¯èƒ½ä¼šæœ‰å¤šä¸ªåº”ç”¨ï¼ŒDjango å¦‚ä½•åˆ†è¾¨é‡åçš„ URL å‘¢ï¼Ÿå…·ä½“æƒ…å†µåˆ™æ˜¯ï¼Œ{% url %} æ ‡ç­¾åˆ°åº•å¯¹åº”å“ªä¸€ä¸ªåº”ç”¨çš„ URL å‘¢ï¼Ÿ</li>
<li><p>åœ¨æ ¹ <code>URLconf</code> ä¸­æ·»åŠ å‘½åç©ºé—´ã€‚åœ¨ polls/urls.py æ–‡ä»¶ä¸­ç¨ä½œä¿®æ”¹ï¼ŒåŠ ä¸Š <code>app_name</code> è®¾ç½®å‘½åç©ºé—´ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line">app_name = <span class="string">'polls'</span></span><br><span class="line">urlpatterns = [</span><br><span class="line">	path(<span class="string">''</span>, views.index, name=<span class="string">'index'</span>),</span><br><span class="line">	path(<span class="string">'&lt;int:question_id&gt;/'</span>, views.detail, name=<span class="string">'detail'</span>),</span><br><span class="line">	path(<span class="string">'&lt;int:question_id&gt;/results/'</span>, views.results, name=<span class="string">'results'</span>),</span><br><span class="line">	path(<span class="string">'&lt;int:question_id&gt;/vote/'</span>, views.vote, name=<span class="string">'vote'</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>ä¿®æ”¹ä¸ºæŒ‡å‘å…·æœ‰å‘½åç©ºé—´çš„è¯¦ç»†è§†å›¾ï¼š</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'polls:detail' question.id %&#125;"</span>&gt;</span></span><br><span class="line">	&#123;&#123; question.question_text &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="è¡¨å•å’Œé€šç”¨è§†å›¾"><a href="#è¡¨å•å’Œé€šç”¨è§†å›¾" class="headerlink" title="è¡¨å•å’Œé€šç”¨è§†å›¾"></a>è¡¨å•å’Œé€šç”¨è§†å›¾</h3><h4 id="è¡¨å•"><a href="#è¡¨å•" class="headerlink" title="è¡¨å•"></a>è¡¨å•</h4><blockquote>
<p>åœ¨æ­¤å°èŠ‚ä¸­ï¼Œé€šè¿‡è¡¨å•æ¥æ”¶æ•°æ®ï¼Œå†é€šè¿‡ Django è§†å›¾æ¥å¤„ç†æäº¤çš„æ•°æ®ã€‚æ­¤è¿‡ç¨‹ï¼Œæ›´åƒæ˜¯å‰ç«¯æ‰“åŒ…æ•°æ®é€šè¿‡ GET/POST è¯·æ±‚ï¼ŒæŠŠæ•°æ®ä¼ é€åˆ°åç«¯ï¼Œäº¤ç”±åç«¯è§†å›¾å¤„ç†æ•°æ®ã€‚</p>
</blockquote>
<ul>
<li><p>ç¼–å†™ä¸€ä¸ªç®€å•çš„è¡¨å•ï¼šè®©æˆ‘ä»¬æ›´æ–°ä¸€ä¸‹åœ¨ä¸Šä¸€ä¸ªæ•™ç¨‹ä¸­ç¼–å†™çš„æŠ•ç¥¨è¯¦ç»†é¡µé¢çš„æ¨¡æ¿  <code>polls/detail.html</code>ï¼Œè®©å®ƒåŒ…å«ä¸€ä¸ª HTML <code>&lt;form&gt;</code> å…ƒç´ ï¼š</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- mystie/templates/polls/detail.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; question.question_text &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">&#123;% if error_message %&#125;</span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>&#123;&#123; error_message &#125;&#125;<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"&#123;% url 'polls:vote' question.id %&#125;"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> | è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ ä¿æŠ¤ï¼š</span></span><br><span class="line"><span class="comment"> | åœ¨ Django ä¸­ï¼Œæ‰€æœ‰é’ˆå¯¹å†…éƒ¨ URL çš„ POST è¡¨å•ï¼Œ</span></span><br><span class="line"><span class="comment"> | éƒ½åº”è¯¥ä½¿ç”¨  &#123;% csrf_token %&#125; æ¨¡æ¿æ ‡ç­¾ã€‚</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">&#123;% csrf_token %&#125;</span><br><span class="line">&#123;% for choice in question.choice_set.all %&#125;</span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"choice"</span> <span class="attr">id</span>=<span class="string">"choice&#123;&#123; forloop.counter &#125;&#125;"</span> <span class="attr">value</span>=<span class="string">"&#123;&#123; choice.id &#125;&#125;"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- æŒ‡ç¤º for æ ‡ç­¾å·²ç»å¾ªç¯å¤šå°‘æ¬¡ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"choice&#123;&#123; forloop.counter &#125;&#125;"</span>&gt;</span>&#123;&#123; choice.choice_text &#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Vote"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><a href="https://docs.djangoproject.com/zh-hans/2.1/ref/csrf/" target="_blank" rel="noopener">è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ ä¿æŠ¤</a>ï¼šå½“æ¶æ„ç½‘ç«™åŒ…å«é“¾æ¥ï¼Œè¡¨å•æŒ‰é’®æˆ–æŸäº›æ—¨åœ¨åœ¨æ‚¨çš„ç½‘ç«™ä¸Šæ‰§è¡ŒæŸäº›æ“ä½œçš„JavaScriptæ—¶ï¼Œä¼šå‘ç”Ÿæ­¤ç±»æ”»å‡»ï¼Œä½¿ç”¨ç™»å½•ç”¨æˆ·è®¿é—®å…¶æµè§ˆå™¨ä¸­çš„æ¶æ„ç½‘ç«™çš„å‡­æ®ã€‚ä¸€ç§ç›¸å…³ç±»å‹çš„æ”»å‡»ï¼Œâ€œç™»å½•CSRFâ€ï¼Œæ”»å‡»ç½‘ç«™æ¬ºéª—ç”¨æˆ·çš„æµè§ˆå™¨ä»¥å…¶ä»–äººçš„å‡­æ®ç™»å½•ç½‘ç«™ä¹Ÿå—åˆ°ä¿æŠ¤ã€‚</p>
</blockquote>
</li>
<li><p>æˆ‘ä»¬ä¸ºæŠ•ç¥¨åº”ç”¨åˆ›å»ºäº†ä¸€ä¸ª URLconf ï¼Œå³æ–°å¢ä¸€è¡Œ <code>path()</code>ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># polls/urls.py</span></span><br><span class="line">path(<span class="string">'&lt;int:question_id&gt;/vote/'</span>, views.vote, name=<span class="string">'vote'</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>åˆ›å»ºä¸€ä¸ª <code>vote()</code> å‡½æ•°ï¼Œæ¥å¤„ç†ç›¸å…³çš„æ•°æ®è¯·æ±‚ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># polls/views.py</span></span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse, HttpResponseRedirect</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> get_object_or_404, render</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> reverse</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Choice, Question</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">vote</span><span class="params">(request, question_id)</span>:</span></span><br><span class="line">	question = get_object_or_404(Question, pk=question_id)</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		selected_choice = question.choice_set.get(pk=request.POST[<span class="string">'choice'</span>])</span><br><span class="line">	<span class="keyword">except</span> (KeyError, Choice.DoesNotExist):</span><br><span class="line">		<span class="comment"># Redisplay the question voting form.</span></span><br><span class="line">		<span class="keyword">return</span> render(request, <span class="string">'polls/detail.html'</span>, &#123;</span><br><span class="line">			<span class="string">'question'</span>: question,</span><br><span class="line">			<span class="string">'error_message'</span>: <span class="string">"You didn't select a choice."</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		selected_choice.votes += <span class="number">1</span></span><br><span class="line">		selected_choice.save()</span><br><span class="line">		<span class="comment"># Always return an HttpResponseRedirect after successfully dealing</span></span><br><span class="line">		<span class="comment"># with POST data. This prevents data from being posted twice if a</span></span><br><span class="line">		<span class="comment"># user hits the Back button.</span></span><br><span class="line">		<span class="keyword">return</span> HttpResponseRedirect(reverse(<span class="string">'polls:results'</span>, args=(question.id,)))</span><br></pre></td></tr></table></figure>
<ul>
<li>ä»£ç è¿”å›ä¸€ä¸ª HttpResponseRedirect è€Œä¸æ˜¯å¸¸ç”¨çš„ HttpResponseï¼›</li>
<li>HttpResponseRedirect åªæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼šç”¨æˆ·å°†è¦è¢«é‡å®šå‘çš„ URLï¼›</li>
<li><p>åœ¨ HttpResponseRedirect çš„æ„é€ å‡½æ•°ä¸­ä½¿ç”¨ reverse() å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°é¿å…äº†æˆ‘ä»¬åœ¨è§†å›¾å‡½æ•°ä¸­ç¡¬ç¼–ç  URLã€‚</p>
<blockquote>
<p>reverse() è°ƒç”¨å°†è¿”å›ä¸€ä¸ªè¿™æ ·çš„å­—ç¬¦ä¸² <code>/polls/3/results/</code>ã€‚<br>å…¶ä¸­ 3 æ˜¯ question.id çš„å€¼ã€‚é‡å®šå‘çš„ URL å°†è°ƒç”¨ â€˜resultsâ€™ è§†å›¾æ¥æ˜¾ç¤ºæœ€ç»ˆçš„é¡µé¢ã€‚</p>
</blockquote>
</li>
</ul>
</li>
<li><p>å½“å¯¹ Question è¿›è¡ŒæŠ•ç¥¨åï¼Œvote() è§†å›¾å°†è¯·æ±‚é‡å®šå‘åˆ° Question çš„ç»“æœç•Œé¢ã€‚è®©æˆ‘ä»¬æ¥ç¼–å†™è¿™ä¸ªè§†å›¾ ( è¿™å’Œä¸Šä¸€ç« èŠ‚ä¸­çš„ detail() è§†å›¾å‡ ä¹ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€çš„ä¸åŒæ˜¯æ¨¡æ¿çš„åå­—ã€‚ æˆ‘ä»¬å°†åœ¨ç¨åè§£å†³è¿™ä¸ªå†—ä½™é—®é¢˜ )ï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># polls/views.py</span></span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> get_object_or_404, render</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">results</span><span class="params">(request, question_id)</span>:</span></span><br><span class="line">	question = get_object_or_404(Question, pk=question_id)</span><br><span class="line">	<span class="keyword">return</span> render(request, <span class="string">'polls/results.html'</span>, &#123;<span class="string">'question'</span>: question&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>å†åˆ›å»ºä¸€ä¸ª <code>polls/results.html</code> æ¨¡æ¿ï¼š</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- polls/templates/polls/results.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; question.question_text &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">&#123;% for choice in question.choice_set.all %&#125;<span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">	&#123;&#123; choice.choice_text &#125;&#125; -- &#123;&#123; choice.votes &#125;&#125; vote&#123;&#123; choice.votes|pluralize &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span>&#123;% endfor %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'polls:detail' question.id %&#125;"</span>&gt;</span>Vote again?<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="é€šç”¨è§†å›¾"><a href="#é€šç”¨è§†å›¾" class="headerlink" title="é€šç”¨è§†å›¾"></a>é€šç”¨è§†å›¾</h4><blockquote>
<p>çŒœæƒ³ï¼šé€šç”¨è§†å›¾æ˜¯å¦æ˜¯é€šç”¨æ¨¡æ¿çš„æ€æƒ³ï¼Œå³ä½¿ç”¨ç»Ÿä¸€çš„ç•Œé¢å±•ç¤ºæ•°æ®ï¼Ÿ</p>
</blockquote>
<ul>
<li>detail() å’Œ results() è§†å›¾éƒ½å¾ˆç®€å•ã€‚å¹¶ä¸”ï¼Œåƒä¸Šé¢æåˆ°çš„é‚£æ ·ï¼Œå­˜åœ¨å†—ä½™é—®é¢˜ã€‚</li>
<li>è¿™äº›è§†å›¾åæ˜ åŸºæœ¬çš„ Web å¼€å‘ä¸­çš„ä¸€ä¸ªå¸¸è§æƒ…å†µï¼šæ ¹æ® URL ä¸­çš„å‚æ•°ä»æ•°æ®åº“ä¸­è·å–æ•°æ®ã€è½½å…¥æ¨¡æ¿æ–‡ä»¶ç„¶åè¿”å›æ¸²æŸ“åçš„æ¨¡æ¿ã€‚ ç”±äºè¿™ç§æƒ…å†µç‰¹åˆ«å¸¸è§ï¼ŒDjango æä¾›ä¸€ç§å¿«æ·æ–¹å¼ï¼Œå«åšâ€œé€šç”¨è§†å›¾â€ç³»ç»Ÿã€‚</li>
<li><p>é€šç”¨è§†å›¾å°†å¸¸è§çš„æ¨¡å¼æŠ½è±¡åŒ–ï¼Œå¯ä»¥ä½¿ä½ åœ¨ç¼–å†™åº”ç”¨æ—¶ç”šè‡³ä¸éœ€è¦ç¼–å†™ Python ä»£ç ã€‚</p>
<blockquote>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œå½“ç¼–å†™ä¸€ä¸ª Django åº”ç”¨æ—¶ï¼Œä½ åº”è¯¥å…ˆè¯„ä¼°ä¸€ä¸‹é€šç”¨è§†å›¾æ˜¯å¦å¯ä»¥è§£å†³ä½ çš„é—®é¢˜ï¼Œä½ åº”è¯¥åœ¨ä¸€å¼€å§‹ä½¿ç”¨å®ƒï¼Œè€Œä¸æ˜¯è¿›è¡Œåˆ°ä¸€åŠæ—¶é‡æ„ä»£ç ã€‚</p>
</blockquote>
</li>
<li><p>è®©æˆ‘ä»¬å°†æˆ‘ä»¬çš„æŠ•ç¥¨åº”ç”¨è½¬æ¢æˆä½¿ç”¨é€šç”¨è§†å›¾ç³»ç»Ÿï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥åˆ é™¤è®¸å¤šæˆ‘ä»¬çš„ä»£ç ã€‚æˆ‘ä»¬ä»…ä»…éœ€è¦åšä»¥ä¸‹å‡ æ­¥æ¥å®Œæˆè½¬æ¢ï¼Œæˆ‘ä»¬å°†ï¼š</p>
<ul>
<li>è½¬æ¢ URLconfã€‚</li>
<li>åˆ é™¤ä¸€äº›æ—§çš„ã€ä¸å†éœ€è¦çš„è§†å›¾ã€‚</li>
<li>åŸºäº Django çš„é€šç”¨è§†å›¾å¼•å…¥æ–°çš„è§†å›¾ã€‚</li>
</ul>
</li>
</ul>
<h5 id="æ”¹è‰¯-URLconf"><a href="#æ”¹è‰¯-URLconf" class="headerlink" title="æ”¹è‰¯ URLconf"></a>æ”¹è‰¯ URLconf</h5><ul>
<li><p>é¦–å…ˆï¼Œæ‰“å¼€ polls/urls.py è¿™ä¸ª URLconf å¹¶å°†å®ƒä¿®æ”¹æˆï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">app_name = <span class="string">'polls'</span></span><br><span class="line">urlpatterns = [</span><br><span class="line">	path(<span class="string">''</span>, views.IndexView.as_view(), name=<span class="string">'index'</span>),</span><br><span class="line">	<span class="comment"># è·¯å¾„å­—ç¬¦ä¸²ä¸­åŒ¹é…æ¨¡å¼çš„åç§°å·²ç»ç”± &lt;question_id&gt; æ”¹ä¸º &lt;pk&gt;</span></span><br><span class="line">	path(<span class="string">'&lt;int:pk&gt;/'</span>, views.DetailView.as_view(), name=<span class="string">'detail'</span>),</span><br><span class="line">	path(<span class="string">'&lt;int:pk&gt;/results/'</span>, views.ResultsView.as_view(), name=<span class="string">'results'</span>),</span><br><span class="line">	path(<span class="string">'&lt;int:question_id&gt;/vote/'</span>, views.vote, name=<span class="string">'vote'</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="æ”¹è‰¯è§†å›¾"><a href="#æ”¹è‰¯è§†å›¾" class="headerlink" title="æ”¹è‰¯è§†å›¾"></a>æ”¹è‰¯è§†å›¾</h5><ul>
<li><p>ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†åˆ é™¤æ—§çš„ index, detail, å’Œ results è§†å›¾ï¼Œå¹¶ç”¨ Django çš„é€šç”¨è§†å›¾ä»£æ›¿ã€‚æ‰“å¼€ polls/views.py æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä¿®æ”¹æˆï¼š</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponseRedirect</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> get_object_or_404, render</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> reverse</span><br><span class="line"><span class="keyword">from</span> django.views <span class="keyword">import</span> generic</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Choice, Question</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexView</span><span class="params">(generic.ListView)</span>:</span></span><br><span class="line">	template_name = <span class="string">'polls/index.html'</span></span><br><span class="line">	context_object_name = <span class="string">'latest_question_list'</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span><span class="params">(self)</span>:</span></span><br><span class="line">       		<span class="comment"># Return the last five published questions.</span></span><br><span class="line">       		<span class="keyword">return</span> Question.objects.order_by(<span class="string">'-pub_date'</span>)[:<span class="number">5</span>]</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DetailView</span><span class="params">(generic.DetailView)</span>:</span></span><br><span class="line">	model = Question</span><br><span class="line">	template_name = <span class="string">'polls/detail.html'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResultsView</span><span class="params">(generic.DetailView)</span>:</span></span><br><span class="line">	model = Question</span><br><span class="line">	template_name = <span class="string">'polls/results.html'</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">vote</span><span class="params">(request, question_id)</span>:</span></span><br><span class="line">		<span class="comment"># Same as above, no changes needed.</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¸Šè¿°ä»£ç è¯¦ç»†è§£é‡Šï¼š        </p>
<ul>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œé€šç”¨è§†å›¾ DetailView ä½¿ç”¨ä¸€ä¸ªå«åš <code>&lt;app name&gt;/&lt;model name&gt;_detail.html</code> çš„æ¨¡æ¿ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒå°†ä½¿ç”¨ <code>polls/question_detail.html</code> æ¨¡æ¿ã€‚</li>
<li><code>template_name</code> å±æ€§æ˜¯ç”¨æ¥å‘Šè¯‰ Django ä½¿ç”¨ä¸€ä¸ªæŒ‡å®šçš„æ¨¡æ¿åå­—ï¼Œè€Œä¸æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„é»˜è®¤åå­—ã€‚ </li>
<li>æˆ‘ä»¬ä¹Ÿä¸º results åˆ—è¡¨è§†å›¾å’Œ detail è§†å›¾æŒ‡å®šäº† template_nameã€‚å³ä½¿å®ƒä»¬åœ¨åå°éƒ½æ˜¯åŒä¸€ä¸ª DetailViewï¼Œresults è§†å›¾å’Œ detail è§†å›¾åœ¨æ¸²æŸ“æ—¶å…·æœ‰ä¸åŒçš„è®¿é—®åç§°ã€‚</li>
<li>ç±»ä¼¼åœ°ï¼ŒListView ä½¿ç”¨ä¸€ä¸ªå«åš <code>&lt;app name&gt;/&lt;model name&gt;_list.html</code> çš„é»˜è®¤æ¨¡æ¿ï¼›æˆ‘ä»¬ä½¿ç”¨ template_name æ¥å‘Šè¯‰ ListView ä½¿ç”¨æˆ‘ä»¬åˆ›å»ºçš„å·²ç»å­˜åœ¨çš„ <code>polls/index.html</code> æ¨¡æ¿ã€‚</li>
<li>åœ¨ä¹‹å‰çš„æ•™ç¨‹ä¸­ï¼Œæä¾›æ¨¡æ¿æ–‡ä»¶æ—¶éƒ½å¸¦æœ‰ä¸€ä¸ªåŒ…å« question å’Œ latest_question_list å˜é‡çš„ contextã€‚<ul>
<li>å¯¹äº DetailView ï¼Œ question å˜é‡ä¼šè‡ªåŠ¨æä¾›â€”â€” å› ä¸ºæˆ‘ä»¬ä½¿ç”¨ Django çš„æ¨¡å‹ (Question)ï¼Œ Django èƒ½å¤Ÿä¸º context å˜é‡å†³å®šä¸€ä¸ªåˆé€‚çš„åå­—ã€‚</li>
<li>å¯¹äº ListViewï¼Œ è‡ªåŠ¨ç”Ÿæˆçš„ context å˜é‡æ˜¯ question_listã€‚ä¸ºäº†è¦†ç›–è¿™ä¸ªè¡Œä¸ºï¼Œæˆ‘ä»¬æä¾› <code>context_object_name</code> å±æ€§ï¼Œè¡¨ç¤ºæˆ‘ä»¬æƒ³ä½¿ç”¨ <code>latest_question_list</code>ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="è‡ªåŠ¨åŒ–æµ‹è¯•"><a href="#è‡ªåŠ¨åŒ–æµ‹è¯•" class="headerlink" title="è‡ªåŠ¨åŒ–æµ‹è¯•"></a>è‡ªåŠ¨åŒ–æµ‹è¯•</h3><h4 id="ä¸ºä»€ä¹ˆä½ éœ€è¦å†™æµ‹è¯•"><a href="#ä¸ºä»€ä¹ˆä½ éœ€è¦å†™æµ‹è¯•" class="headerlink" title="ä¸ºä»€ä¹ˆä½ éœ€è¦å†™æµ‹è¯•"></a>ä¸ºä»€ä¹ˆä½ éœ€è¦å†™æµ‹è¯•</h4><ul>
<li><code>æµ‹è¯•å°†èŠ‚çº¦ä½ çš„æ—¶é—´</code>ï¼šåœ¨å¤æ‚çš„åº”ç”¨ç¨‹åºä¸­ï¼Œç»„ä»¶ä¹‹é—´å¯èƒ½ä¼šæœ‰æ•°åä¸ªå¤æ‚çš„äº¤äº’ã€‚æ”¹å˜å…¶ä¸­æŸä¸€ç»„ä»¶çš„è¡Œä¸ºï¼Œä¹Ÿæœ‰å¯èƒ½ä¼šé€ æˆæ„æƒ³ä¸åˆ°çš„ç»“æœã€‚åˆ¤æ–­ã€Œä»£ç æ˜¯å¦æ­£å¸¸å·¥ä½œã€æ„å‘³ç€ä½ éœ€è¦ç”¨å¤§é‡çš„æ•°æ®æ¥å®Œæ•´çš„æµ‹è¯•å…¨éƒ¨ä»£ç çš„åŠŸèƒ½ï¼Œä»¥ç¡®ä¿ä½ çš„å°ä¿®æ”¹æ²¡æœ‰å¯¹åº”ç”¨æ•´ä½“é€ æˆç ´åï¼Œå¯æƒ³è€ŒçŸ¥å…¶ä¸­çš„å·¥ä½œé‡ã€‚</li>
<li><code>æµ‹è¯•ä¸ä»…èƒ½å‘ç°é”™è¯¯ä¸”èƒ½é¢„é˜²é”™è¯¯</code>ï¼šæµ‹è¯•æ˜¯å¼€å‘çš„å¯¹ç«‹é¢ï¼Œè¿™ç§æ€æƒ³æ˜¯ä¸å¯¹çš„ï¼Œå¼€å‘å…¶å®æ›´åƒæ˜¯ä¸€ä¸ªä¸æ–­è¯•é”™çš„è¿‡ç¨‹ã€‚</li>
</ul>
<h4 id="å¼€å§‹å†™ä¸€ä¸ªæµ‹è¯•ç¨‹åº"><a href="#å¼€å§‹å†™ä¸€ä¸ªæµ‹è¯•ç¨‹åº" class="headerlink" title="å¼€å§‹å†™ä¸€ä¸ªæµ‹è¯•ç¨‹åº"></a>å¼€å§‹å†™ä¸€ä¸ªæµ‹è¯•ç¨‹åº</h4><ul>
<li>çº¦å®šä¿—ç§°ï¼ŒDjango åº”ç”¨çš„æµ‹è¯•åº”è¯¥å†™åœ¨åº”ç”¨çš„ <code>tests.py</code> æ–‡ä»¶é‡Œï¼Œæµ‹è¯•ç³»ç»Ÿä¼šè‡ªåŠ¨çš„åœ¨æ‰€æœ‰ä»¥ tests å¼€å¤´çš„æ–‡ä»¶é‡Œå¯»æ‰¾å¹¶æ‰§è¡Œæµ‹è¯•ä»£ç ã€‚</li>
<li><p>åˆ¶é€ ä¸€ä¸ª BUGï¼šç»§ç»­ä¸Šè¿°æåŠçš„åº”ç”¨ Pollsï¼Œè¦æ±‚ Question æ˜¯åœ¨ä¸€å¤©ä¹‹å†…å‘å¸ƒï¼Œ åˆ™ Question.was_published_recently() æ–¹æ³•å°†ä¼šè¿”å› True ã€‚ç„¶è€Œç°åœ¨è¿™ä¸ªæ–¹æ³•åœ¨ Question çš„ pub_date å­—æ®µæ¯”å½“å‰æ—¶é—´è¿˜æ™š ( æœªæ¥çš„æ—¶é—´ ) æ—¶ä¹Ÿä¼šè¿”å› Trueã€‚</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> django.utils <span class="keyword">import</span> timezone</span><br><span class="line"><span class="keyword">from</span> polls.models <span class="keyword">import</span> Question</span><br><span class="line"><span class="comment"># create a Question instance with pub_date 30 days in the future</span></span><br><span class="line">time = timezone.now() + datetime.timedelta(days=<span class="number">30</span>)</span><br><span class="line">future_question = Question(pub_date=time)</span><br><span class="line"><span class="comment"># was it published recently? ==&gt; True</span></span><br><span class="line">future_question.was_published_recently()</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ›é€ ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼šåˆ›å»ºä¸€ä¸ª <code>django.test.TestCase</code> çš„å­ç±»ã€‚</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> django.utils <span class="keyword">import</span> timezone</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Question</span><br><span class="line"><span class="keyword">from</span> django.test <span class="keyword">import</span> TestCase</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QuestionModelTests</span><span class="params">(TestCase)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_was_published_recently_with_future_question</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        was_published_recently() returns False </span></span><br><span class="line"><span class="string">        for questions whose pub_date is in the future.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        time = timezone.now() + datetime.timedelta(days=<span class="number">30</span>)</span><br><span class="line">        future_question = Question(pub_date=time)</span><br><span class="line">        self.assertIs(future_question.was_published_recently(), <span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>æœ€åï¼Œæˆ‘ä»¬å¯é€šè¿‡ PyCharm å•ç‹¬è¿è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç»ˆç«¯å‘½ä»¤è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py <span class="built_in">test</span> polls</span><br></pre></td></tr></table></figure>
</li>
<li><p>å‘ç”Ÿäº†ä»€ä¹ˆå‘¢ï¼Ÿä»¥ä¸‹æ˜¯è‡ªåŠ¨åŒ–æµ‹è¯•çš„è¿è¡Œè¿‡ç¨‹ï¼š</p>
<ul>
<li><code>python manage.py test polls</code> å°†ä¼šå¯»æ‰¾ Polls åº”ç”¨é‡Œçš„æµ‹è¯•ä»£ç ï¼Œå®ƒæ‰¾åˆ°äº† django.test.TestCase çš„ä¸€ä¸ªå­ç±»ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªç‰¹æ®Šçš„æ•°æ®åº“ä¾›æµ‹è¯•ä½¿ç”¨ï¼›</li>
<li>åœ¨ç±»ä¸­å¯»æ‰¾æµ‹è¯•æ–¹æ³• ( ä»¥ test å¼€å¤´çš„ )ï¼Œåœ¨ <code>test_was_published_recently_with_future_question</code> æ–¹æ³•ä¸­ï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ª pub_date å€¼ä¸º 30 å¤©åçš„ Question å®ä¾‹ã€‚</li>
<li>æ¥ç€ä½¿ç”¨ <code>assertls()</code> æ–¹æ³•ï¼Œå‘ç° <code>was_published_recently()</code> è¿”å›äº† Trueï¼Œè€Œæˆ‘ä»¬æœŸæœ›å®ƒè¿”å› Falseã€‚</li>
</ul>
</li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li>[1] <a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001432712108300322c61f256c74803b43bfd65c6f8d0d0000" target="_blank" rel="noopener">å»–é›ªå³°. Python æ•™ç¨‹ä¹‹ virtualenv. 2017. liaoxuefeng.com</a></li>
<li>[2] <a href="https://zhuanlan.zhihu.com/p/31447222" target="_blank" rel="noopener">åœ°çƒçš„å¤–æ˜Ÿäººå›. Python Web æ¡†æ¶å¤§ä¹±æ–—ï¼šå“ªä¸ªæ¡†æ¶é€‚åˆä½ . 2017. zhihu.com</a></li>
<li>[3] <a href="https://www.zhihu.com/question/20706333" target="_blank" rel="noopener">çŸ¥ä¹é—®ç­”. Python æœ‰å“ªäº›å¥½çš„ Web æ¡†æ¶. zhihu.com</a></li>
</ul>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š</strong>
    Kofe
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="http://www.kofes.cn/2019/02/Django.html" title="Djangoï¼šWeb æ¡†æ¶ä»å…¥é—¨åˆ°åº”ç”¨">http://www.kofes.cn/2019/02/Django.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>
    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/" rel="tag"># python</a>
          
            <a href="/tags/web/" rel="tag"># web</a>
          
            <a href="/tags/django/" rel="tag"># django</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/02/FastDFS.html" rel="next" title="FastDFSï¼šæ–‡ä»¶ç³»ç»Ÿä»å…¥é—¨åˆ°åº”ç”¨">
                <i class="fa fa-chevron-left"></i> FastDFSï¼šæ–‡ä»¶ç³»ç»Ÿä»å…¥é—¨åˆ°åº”ç”¨
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/08/root-cause-analysis-alarm-clustering.html" rel="prev" title="è®ºæ–‡ | åŸºäºæ ¹å› åˆ†æçš„æŠ¥è­¦èšç±»ç®—æ³•">
                è®ºæ–‡ | åŸºäºæ ¹å› åˆ†æçš„æŠ¥è­¦èšç±»ç®—æ³• <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/profile/society_face_version_1.jpg" alt="Kofe">
            
              <p class="site-author-name" itemprop="name">Kofe</p>
              <p class="site-description motion-element" itemprop="description">èåˆå·¥ç¨‹ã€ç¾å­¦ã€æ•°æ®çš„æ€ç»´åŠèƒ½åŠ›ï¼Œ<br>åˆ›ä½œæœ€ä¼˜è´¨å†…å®¹ï¼Œæ„¿ä¸ç²‰ä¸å…±è¿›æ­¥ã€å…±æˆé•¿ã€‚</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">44</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">171</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/ldxw8" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://dribbble.com/Kofe" target="_blank" title="Dribbble">
                      
                        <i class="fa fa-fw fa-dribbble"></i>Dribbble</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://weibo.com/ldxw8" target="_blank" title="Weibo">
                      
                        <i class="fa fa-fw fa-weibo"></i>Weibo</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.acxer.cn" title="zcxer" target="_blank">zcxer</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#æ•™å­¦èµ„æº"><span class="nav-number">1.</span> <span class="nav-text">æ•™å­¦èµ„æº</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¿«é€Ÿä¸Šæ‰‹"><span class="nav-number">2.</span> <span class="nav-text">å¿«é€Ÿä¸Šæ‰‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å®‰è£…ä¸é…ç½®"><span class="nav-number">2.1.</span> <span class="nav-text">å®‰è£…ä¸é…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¯·æ±‚ä¸å“åº”"><span class="nav-number">2.2.</span> <span class="nav-text">è¯·æ±‚ä¸å“åº”</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#è¿”å›å†…å®¹è‡³é¡µé¢"><span class="nav-number">2.2.1.</span> <span class="nav-text">è¿”å›å†…å®¹è‡³é¡µé¢</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è¿”å›ç‹¬ç«‹-Html-é¡µé¢"><span class="nav-number">2.2.2.</span> <span class="nav-text">è¿”å›ç‹¬ç«‹ Html é¡µé¢</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®€å•ç™»å½•åŠŸèƒ½"><span class="nav-number">2.3.</span> <span class="nav-text">ç®€å•ç™»å½•åŠŸèƒ½</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¢åˆ æ”¹æŸ¥ç³»ç»Ÿ"><span class="nav-number">2.4.</span> <span class="nav-text">å¢åˆ æ”¹æŸ¥ç³»ç»Ÿ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#å»ºç«‹æ•°æ®è¡¨"><span class="nav-number">2.4.1.</span> <span class="nav-text">å»ºç«‹æ•°æ®è¡¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å‰-åç«¯äº¤äº’åŸç†"><span class="nav-number">2.4.2.</span> <span class="nav-text">å‰ / åç«¯äº¤äº’åŸç†</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åŸç”Ÿä»£ç æ“ä½œæ•°æ®"><span class="nav-number">2.4.3.</span> <span class="nav-text">åŸç”Ÿä»£ç æ“ä½œæ•°æ®</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Ajax-æ–¹å¼äº¤äº’æ•°æ®"><span class="nav-number">2.4.4.</span> <span class="nav-text">Ajax æ–¹å¼äº¤äº’æ•°æ®</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¡†æ¶æ­£æ–‡"><span class="nav-number">3.</span> <span class="nav-text">æ¡†æ¶æ­£æ–‡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ•°æ®åº“é…ç½®"><span class="nav-number">3.1.</span> <span class="nav-text">æ•°æ®åº“é…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ¨¡å‹å’Œç«™ç‚¹ç®¡ç†"><span class="nav-number">3.2.</span> <span class="nav-text">æ¨¡å‹å’Œç«™ç‚¹ç®¡ç†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#åˆ›å»ºæ¨¡å‹"><span class="nav-number">3.2.1.</span> <span class="nav-text">åˆ›å»ºæ¨¡å‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ¿€æ´»æ¨¡å‹"><span class="nav-number">3.2.2.</span> <span class="nav-text">æ¿€æ´»æ¨¡å‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ•°æ®æ“ä½œ"><span class="nav-number">3.2.3.</span> <span class="nav-text">æ•°æ®æ“ä½œ</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#åˆ›å»ºå¯¹è±¡"><span class="nav-number">3.2.3.1.</span> <span class="nav-text">åˆ›å»ºå¯¹è±¡</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æ›´æ–°å¯¹è±¡"><span class="nav-number">3.2.3.2.</span> <span class="nav-text">æ›´æ–°å¯¹è±¡</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æ£€ç´¢å¯¹è±¡"><span class="nav-number">3.2.3.3.</span> <span class="nav-text">æ£€ç´¢å¯¹è±¡</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ç«™ç‚¹ç®¡ç†"><span class="nav-number">3.2.4.</span> <span class="nav-text">ç«™ç‚¹ç®¡ç†</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#å¼€ç¯‡å¼•è¨€"><span class="nav-number">3.2.4.1.</span> <span class="nav-text">å¼€ç¯‡å¼•è¨€</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#åˆ›å»ºç®¡ç†å‘˜è´¦å·"><span class="nav-number">3.2.4.2.</span> <span class="nav-text">åˆ›å»ºç®¡ç†å‘˜è´¦å·</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¯åŠ¨å¼€å‘æœåŠ¡å™¨"><span class="nav-number">3.2.4.3.</span> <span class="nav-text">å¯åŠ¨å¼€å‘æœåŠ¡å™¨</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç®¡ç†é¡µæ·»åŠ åº”ç”¨"><span class="nav-number">3.2.4.4.</span> <span class="nav-text">ç®¡ç†é¡µæ·»åŠ åº”ç”¨</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ¨¡æ¿å’Œè§†å›¾"><span class="nav-number">3.3.</span> <span class="nav-text">æ¨¡æ¿å’Œè§†å›¾</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#å¼€ç¯‡å¼•è¨€-1"><span class="nav-number">3.3.1.</span> <span class="nav-text">å¼€ç¯‡å¼•è¨€</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ¨¡æ¿ç³»ç»Ÿ"><span class="nav-number">3.3.2.</span> <span class="nav-text">æ¨¡æ¿ç³»ç»Ÿ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å°è¯•ç‰›åˆ€"><span class="nav-number">3.3.3.</span> <span class="nav-text">å°è¯•ç‰›åˆ€</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä½¿ç”¨æ¨¡æ¿ç³»ç»Ÿ"><span class="nav-number">3.3.4.</span> <span class="nav-text">ä½¿ç”¨æ¨¡æ¿ç³»ç»Ÿ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å»é™¤æ¨¡æ¿ä¸­çš„ç¡¬ç¼–ç -URL"><span class="nav-number">3.3.5.</span> <span class="nav-text">å»é™¤æ¨¡æ¿ä¸­çš„ç¡¬ç¼–ç  URL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä¸º-URL-åç§°æ·»åŠ å‘½åç©ºé—´"><span class="nav-number">3.3.6.</span> <span class="nav-text">ä¸º URL åç§°æ·»åŠ å‘½åç©ºé—´</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¡¨å•å’Œé€šç”¨è§†å›¾"><span class="nav-number">3.4.</span> <span class="nav-text">è¡¨å•å’Œé€šç”¨è§†å›¾</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#è¡¨å•"><span class="nav-number">3.4.1.</span> <span class="nav-text">è¡¨å•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é€šç”¨è§†å›¾"><span class="nav-number">3.4.2.</span> <span class="nav-text">é€šç”¨è§†å›¾</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#æ”¹è‰¯-URLconf"><span class="nav-number">3.4.2.1.</span> <span class="nav-text">æ”¹è‰¯ URLconf</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æ”¹è‰¯è§†å›¾"><span class="nav-number">3.4.2.2.</span> <span class="nav-text">æ”¹è‰¯è§†å›¾</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è‡ªåŠ¨åŒ–æµ‹è¯•"><span class="nav-number">3.5.</span> <span class="nav-text">è‡ªåŠ¨åŒ–æµ‹è¯•</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ä¸ºä»€ä¹ˆä½ éœ€è¦å†™æµ‹è¯•"><span class="nav-number">3.5.1.</span> <span class="nav-text">ä¸ºä»€ä¹ˆä½ éœ€è¦å†™æµ‹è¯•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å¼€å§‹å†™ä¸€ä¸ªæµ‹è¯•ç¨‹åº"><span class="nav-number">3.5.2.</span> <span class="nav-text">å¼€å§‹å†™ä¸€ä¸ªæµ‹è¯•ç¨‹åº</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‚è€ƒèµ„æ–™"><span class="nav-number">4.</span> <span class="nav-text">å‚è€ƒèµ„æ–™</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Kofe</span>

  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>








        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: true,
        notify: true,
        appId: 'STGXfYUEVVq1AoccxhumXjsB-gzGzoHsz',
        appKey: 'jbgIHEzUigo8apYgTon6xXE8',
        placeholder: 'éå¸¸æœŸå¾…æ‚¨çš„æƒ³æ³•æˆ–æ„è§ï¼Œæ¨èç•™è¨€~',
        avatar:'hide',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("STGXfYUEVVq1AoccxhumXjsB-gzGzoHsz", "jbgIHEzUigo8apYgTon6xXE8");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
